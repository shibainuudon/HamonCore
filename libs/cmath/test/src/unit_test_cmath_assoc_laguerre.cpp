/**
 *	@file	unit_test_cmath_assoc_laguerre.cpp
 *
 *	@brief	assoc_laguerre のテスト
 */

#include <hamon/cmath/assoc_laguerre.hpp>
#include <hamon/cmath/isnan.hpp>
#include <hamon/cmath/abs.hpp>
#include <hamon/type_traits/is_same.hpp>
#include <gtest/gtest.h>
#include <limits>
#include "constexpr_test.hpp"

namespace hamon_cmath_test
{

namespace assoc_laguerre_test
{

static_assert(hamon::is_same<float,       decltype(hamon::assoc_laguerre(0u, 0u, 0.0f))>::value, "");
static_assert(hamon::is_same<float,       decltype(hamon::assoc_laguerref(0u, 0u, 0.0f))>::value, "");
static_assert(hamon::is_same<double,      decltype(hamon::assoc_laguerre(0u, 0u, 0.0))>::value, "");
static_assert(hamon::is_same<long double, decltype(hamon::assoc_laguerre(0u, 0u, 0.0l))>::value, "");
static_assert(hamon::is_same<long double, decltype(hamon::assoc_laguerrel(0u, 0u, 0.0l))>::value, "");
static_assert(hamon::is_same<double,      decltype(hamon::assoc_laguerre(0u, 0u, 0))>::value, "");

template <typename T>
void AssocLaguerreTest(double error)
{
	using Promoted = hamon::float_promote_t<T>;
	HAMON_CXX11_CONSTEXPR auto nan = std::numeric_limits<Promoted>::quiet_NaN();
	HAMON_CXX11_CONSTEXPR auto inf = std::numeric_limits<Promoted>::infinity();
	HAMON_CXX11_CONSTEXPR auto min = std::numeric_limits<Promoted>::lowest();
	HAMON_CXX11_CONSTEXPR auto max = std::numeric_limits<Promoted>::max();

	HAMON_CXX14_CONSTEXPR_EXPECT_TRUE(hamon::isnan(hamon::assoc_laguerre(0, 0, nan)));
	HAMON_CXX14_CONSTEXPR_EXPECT_TRUE(hamon::isnan(hamon::assoc_laguerre(1, 1, nan)));
	HAMON_CXX14_CONSTEXPR_EXPECT_TRUE(hamon::isnan(hamon::assoc_laguerre(0, 2, T(-1))));
	HAMON_CXX14_CONSTEXPR_EXPECT_TRUE(hamon::isnan(hamon::assoc_laguerre(1, 3, T(-1))));

	HAMON_CXX14_CONSTEXPR_EXPECT_EQ(T(  1.0), hamon::assoc_laguerre( 0,  0, T(0)));
	HAMON_CXX14_CONSTEXPR_EXPECT_EQ(T(  1.0), hamon::assoc_laguerre( 0, 10, T(100)));
	HAMON_CXX14_CONSTEXPR_EXPECT_EQ(T( -9.0), hamon::assoc_laguerre( 1,  0, T(10)));
	HAMON_CXX14_CONSTEXPR_EXPECT_EQ(T(-14.0), hamon::assoc_laguerre( 1,  5, T(20)));
	HAMON_CXX14_CONSTEXPR_EXPECT_EQ(T( 23.0), hamon::assoc_laguerre( 2,  1, T(10)));
	HAMON_CXX14_CONSTEXPR_EXPECT_EQ(T( 46.0), hamon::assoc_laguerre( 2, 50, T(40)));
	HAMON_CXX14_CONSTEXPR_EXPECT_EQ(T(252.0), hamon::assoc_laguerre( 5,  5, T(0)));
	HAMON_CXX14_CONSTEXPR_EXPECT_EQ(T(130.0), hamon::assoc_laguerre( 5, 20, T(20)));
	HAMON_CXX14_CONSTEXPR_EXPECT_EQ(T( 66.0), hamon::assoc_laguerre(10,  2, T(0)));

	struct testcase
	{
		double expected;
		unsigned int n;
		unsigned int m;
		T x;
	};

	static testcase const testcases[] =
	{
		{1.0000000000000000, 0, 0,   0},
		{1.0000000000000000, 0, 0,  10},
		{1.0000000000000000, 0, 0,  20},
		{1.0000000000000000, 0, 0,  30},
		{1.0000000000000000, 0, 0,  40},
		{1.0000000000000000, 0, 0,  50},
		{1.0000000000000000, 0, 0,  60},
		{1.0000000000000000, 0, 0,  70},
		{1.0000000000000000, 0, 0,  80},
		{1.0000000000000000, 0, 0,  90},
		{1.0000000000000000, 0, 0, 100},

		{1.0000000000000000, 0, 1,   0},
		{1.0000000000000000, 0, 1,  10},
		{1.0000000000000000, 0, 1,  20},
		{1.0000000000000000, 0, 1,  30},
		{1.0000000000000000, 0, 1,  40},
		{1.0000000000000000, 0, 1,  50},
		{1.0000000000000000, 0, 1,  60},
		{1.0000000000000000, 0, 1,  70},
		{1.0000000000000000, 0, 1,  80},
		{1.0000000000000000, 0, 1,  90},
		{1.0000000000000000, 0, 1, 100},

		{1.0000000000000000, 0, 2,   0},
		{1.0000000000000000, 0, 2,  10},
		{1.0000000000000000, 0, 2,  20},
		{1.0000000000000000, 0, 2,  30},
		{1.0000000000000000, 0, 2,  40},
		{1.0000000000000000, 0, 2,  50},
		{1.0000000000000000, 0, 2,  60},
		{1.0000000000000000, 0, 2,  70},
		{1.0000000000000000, 0, 2,  80},
		{1.0000000000000000, 0, 2,  90},
		{1.0000000000000000, 0, 2, 100},

		{1.0000000000000000, 0, 5,   0},
		{1.0000000000000000, 0, 5,  10},
		{1.0000000000000000, 0, 5,  20},
		{1.0000000000000000, 0, 5,  30},
		{1.0000000000000000, 0, 5,  40},
		{1.0000000000000000, 0, 5,  50},
		{1.0000000000000000, 0, 5,  60},
		{1.0000000000000000, 0, 5,  70},
		{1.0000000000000000, 0, 5,  80},
		{1.0000000000000000, 0, 5,  90},
		{1.0000000000000000, 0, 5, 100},

		{1.0000000000000000, 0, 10,   0},
		{1.0000000000000000, 0, 10,  10},
		{1.0000000000000000, 0, 10,  20},
		{1.0000000000000000, 0, 10,  30},
		{1.0000000000000000, 0, 10,  40},
		{1.0000000000000000, 0, 10,  50},
		{1.0000000000000000, 0, 10,  60},
		{1.0000000000000000, 0, 10,  70},
		{1.0000000000000000, 0, 10,  80},
		{1.0000000000000000, 0, 10,  90},
		{1.0000000000000000, 0, 10, 100},

		{1.0000000000000000, 0, 20,   0},
		{1.0000000000000000, 0, 20,  10},
		{1.0000000000000000, 0, 20,  20},
		{1.0000000000000000, 0, 20,  30},
		{1.0000000000000000, 0, 20,  40},
		{1.0000000000000000, 0, 20,  50},
		{1.0000000000000000, 0, 20,  60},
		{1.0000000000000000, 0, 20,  70},
		{1.0000000000000000, 0, 20,  80},
		{1.0000000000000000, 0, 20,  90},
		{1.0000000000000000, 0, 20, 100},

		{1.0000000000000000, 0, 50,   0},
		{1.0000000000000000, 0, 50,  10},
		{1.0000000000000000, 0, 50,  20},
		{1.0000000000000000, 0, 50,  30},
		{1.0000000000000000, 0, 50,  40},
		{1.0000000000000000, 0, 50,  50},
		{1.0000000000000000, 0, 50,  60},
		{1.0000000000000000, 0, 50,  70},
		{1.0000000000000000, 0, 50,  80},
		{1.0000000000000000, 0, 50,  90},
		{1.0000000000000000, 0, 50, 100},

		{1.0000000000000000, 0, 100,   0},
		{1.0000000000000000, 0, 100,  10},
		{1.0000000000000000, 0, 100,  20},
		{1.0000000000000000, 0, 100,  30},
		{1.0000000000000000, 0, 100,  40},
		{1.0000000000000000, 0, 100,  50},
		{1.0000000000000000, 0, 100,  60},
		{1.0000000000000000, 0, 100,  70},
		{1.0000000000000000, 0, 100,  80},
		{1.0000000000000000, 0, 100,  90},
		{1.0000000000000000, 0, 100, 100},

		{ 1.0000000000000000, 1, 0,   0},
		{-9.0000000000000000, 1, 0,  10},
		{-19.000000000000000, 1, 0,  20},
		{-29.000000000000000, 1, 0,  30},
		{-39.000000000000000, 1, 0,  40},
		{-49.000000000000000, 1, 0,  50},
		{-59.000000000000000, 1, 0,  60},
		{-69.000000000000000, 1, 0,  70},
		{-79.000000000000000, 1, 0,  80},
		{-89.000000000000000, 1, 0,  90},
		{-99.000000000000000, 1, 0, 100},

		{ 2.0000000000000000, 1, 1,   0},
		{-8.0000000000000000, 1, 1,  10},
		{-18.000000000000000, 1, 1,  20},
		{-28.000000000000000, 1, 1,  30},
		{-38.000000000000000, 1, 1,  40},
		{-48.000000000000000, 1, 1,  50},
		{-58.000000000000000, 1, 1,  60},
		{-68.000000000000000, 1, 1,  70},
		{-78.000000000000000, 1, 1,  80},
		{-88.000000000000000, 1, 1,  90},
		{-98.000000000000000, 1, 1, 100},

		{ 3.0000000000000000, 1, 2,   0},
		{-7.0000000000000000, 1, 2,  10},
		{-17.000000000000000, 1, 2,  20},
		{-27.000000000000000, 1, 2,  30},
		{-37.000000000000000, 1, 2,  40},
		{-47.000000000000000, 1, 2,  50},
		{-57.000000000000000, 1, 2,  60},
		{-67.000000000000000, 1, 2,  70},
		{-77.000000000000000, 1, 2,  80},
		{-87.000000000000000, 1, 2,  90},
		{-97.000000000000000, 1, 2, 100},

		{ 6.0000000000000000, 1, 5,   0},
		{-4.0000000000000000, 1, 5,  10},
		{-14.000000000000000, 1, 5,  20},
		{-24.000000000000000, 1, 5,  30},
		{-34.000000000000000, 1, 5,  40},
		{-44.000000000000000, 1, 5,  50},
		{-54.000000000000000, 1, 5,  60},
		{-64.000000000000000, 1, 5,  70},
		{-74.000000000000000, 1, 5,  80},
		{-84.000000000000000, 1, 5,  90},
		{-94.000000000000000, 1, 5, 100},

		{ 11.000000000000000, 1, 10,   0},
		{ 1.0000000000000000, 1, 10,  10},
		{-9.0000000000000000, 1, 10,  20},
		{-19.000000000000000, 1, 10,  30},
		{-29.000000000000000, 1, 10,  40},
		{-39.000000000000000, 1, 10,  50},
		{-49.000000000000000, 1, 10,  60},
		{-59.000000000000000, 1, 10,  70},
		{-69.000000000000000, 1, 10,  80},
		{-79.000000000000000, 1, 10,  90},
		{-89.000000000000000, 1, 10, 100},

		{ 21.000000000000000, 1, 20,   0},
		{ 11.000000000000000, 1, 20,  10},
		{ 1.0000000000000000, 1, 20,  20},
		{-9.0000000000000000, 1, 20,  30},
		{-19.000000000000000, 1, 20,  40},
		{-29.000000000000000, 1, 20,  50},
		{-39.000000000000000, 1, 20,  60},
		{-49.000000000000000, 1, 20,  70},
		{-59.000000000000000, 1, 20,  80},
		{-69.000000000000000, 1, 20,  90},
		{-79.000000000000000, 1, 20, 100},

		{ 51.000000000000000, 1, 50,   0},
		{ 41.000000000000000, 1, 50,  10},
		{ 31.000000000000000, 1, 50,  20},
		{ 21.000000000000000, 1, 50,  30},
		{ 11.000000000000000, 1, 50,  40},
		{ 1.0000000000000000, 1, 50,  50},
		{-9.0000000000000000, 1, 50,  60},
		{-19.000000000000000, 1, 50,  70},
		{-29.000000000000000, 1, 50,  80},
		{-39.000000000000000, 1, 50,  90},
		{-49.000000000000000, 1, 50, 100},

		{101.00000000000000, 1, 100,   0},
		{91.000000000000000, 1, 100,  10},
		{81.000000000000000, 1, 100,  20},
		{71.000000000000000, 1, 100,  30},
		{61.000000000000000, 1, 100,  40},
		{51.000000000000000, 1, 100,  50},
		{41.000000000000000, 1, 100,  60},
		{31.000000000000000, 1, 100,  70},
		{21.000000000000000, 1, 100,  80},
		{11.000000000000000, 1, 100,  90},
		{1.0000000000000000, 1, 100, 100},

		{1.0000000000000000, 2, 0,   0},
		{31.000000000000000, 2, 0,  10},
		{161.00000000000000, 2, 0,  20},
		{391.00000000000000, 2, 0,  30},
		{721.00000000000000, 2, 0,  40},
		{1151.0000000000000, 2, 0,  50},
		{1681.0000000000000, 2, 0,  60},
		{2311.0000000000000, 2, 0,  70},
		{3041.0000000000000, 2, 0,  80},
		{3871.0000000000000, 2, 0,  90},
		{4801.0000000000000, 2, 0, 100},

		{3.0000000000000000, 2, 1,   0},
		{23.000000000000000, 2, 1,  10},
		{143.00000000000000, 2, 1,  20},
		{363.00000000000000, 2, 1,  30},
		{683.00000000000000, 2, 1,  40},
		{1103.0000000000000, 2, 1,  50},
		{1623.0000000000000, 2, 1,  60},
		{2243.0000000000000, 2, 1,  70},
		{2963.0000000000000, 2, 1,  80},
		{3783.0000000000000, 2, 1,  90},
		{4703.0000000000000, 2, 1, 100},

		{6.0000000000000000, 2, 2,   0},
		{16.000000000000000, 2, 2,  10},
		{126.00000000000000, 2, 2,  20},
		{336.00000000000000, 2, 2,  30},
		{646.00000000000000, 2, 2,  40},
		{1056.0000000000000, 2, 2,  50},
		{1566.0000000000000, 2, 2,  60},
		{2176.0000000000000, 2, 2,  70},
		{2886.0000000000000, 2, 2,  80},
		{3696.0000000000000, 2, 2,  90},
		{4606.0000000000000, 2, 2, 100},

		{21.000000000000000, 2, 5,   0},
		{1.0000000000000000, 2, 5,  10},
		{81.000000000000000, 2, 5,  20},
		{261.00000000000000, 2, 5,  30},
		{541.00000000000000, 2, 5,  40},
		{921.00000000000000, 2, 5,  50},
		{1401.0000000000000, 2, 5,  60},
		{1981.0000000000000, 2, 5,  70},
		{2661.0000000000000, 2, 5,  80},
		{3441.0000000000000, 2, 5,  90},
		{4321.0000000000000, 2, 5, 100},

		{ 66.000000000000000, 2, 10,   0},
		{-4.0000000000000000, 2, 10,  10},
		{ 26.000000000000000, 2, 10,  20},
		{ 156.00000000000000, 2, 10,  30},
		{ 386.00000000000000, 2, 10,  40},
		{ 716.00000000000000, 2, 10,  50},
		{1146.00000000000000, 2, 10,  60},
		{1676.00000000000000, 2, 10,  70},
		{2306.00000000000000, 2, 10,  80},
		{3036.00000000000000, 2, 10,  90},
		{3866.00000000000000, 2, 10, 100},

		{231.00000000000000, 2, 20,   0},
		{61.000000000000000, 2, 20,  10},
		{-9.000000000000000, 2, 20,  20},
		{21.000000000000000, 2, 20,  30},
		{151.00000000000000, 2, 20,  40},
		{381.00000000000000, 2, 20,  50},
		{711.00000000000000, 2, 20,  60},
		{1141.0000000000000, 2, 20,  70},
		{1671.0000000000000, 2, 20,  80},
		{2301.0000000000000, 2, 20,  90},
		{3031.0000000000000, 2, 20, 100},

		{1326.0000000000000, 2, 50,   0},
		{856.00000000000000, 2, 50,  10},
		{486.00000000000000, 2, 50,  20},
		{216.00000000000000, 2, 50,  30},
		{46.000000000000000, 2, 50,  40},
		{-24.00000000000000, 2, 50,  50},
		{6.0000000000000000, 2, 50,  60},
		{136.00000000000000, 2, 50,  70},
		{366.00000000000000, 2, 50,  80},
		{696.00000000000000, 2, 50,  90},
		{1126.0000000000000, 2, 50, 100},

		{5151.0000000000000, 2, 100,   0},
		{4181.0000000000000, 2, 100,  10},
		{3311.0000000000000, 2, 100,  20},
		{2541.0000000000000, 2, 100,  30},
		{1871.0000000000000, 2, 100,  40},
		{1301.0000000000000, 2, 100,  50},
		{831.00000000000000, 2, 100,  60},
		{461.00000000000000, 2, 100,  70},
		{191.00000000000000, 2, 100,  80},
		{21.000000000000000, 2, 100,  90},
		{-49.00000000000000, 2, 100, 100},

		{ 1.0000000000000000, 5, 0,   0},
		{ 34.333333333333333, 5, 0,  10},
		{-4765.6666666666666, 5, 0,  20},
		{-74399.000000000000, 5, 0,  30},
		{-418865.66666666666, 5, 0,  40},
		{-1498165.6666666666, 5, 0,  50},
		{-4122299.0000000000, 5, 0,  60},
		{-9551265.6666666666, 5, 0,  70},
		{-19595065.666666666, 5, 0,  80},
		{-36713699.000000000, 5, 0,  90},
		{-64117165.666666666, 5, 0, 100},

		{ 6.0000000000000000, 5, 1,   0},
		{ 22.666666666666666, 5, 1,  10},
		{-2960.6666666666666, 5, 1,  20},
		{-58944.000000000000, 5, 1,  30},
		{-357927.33333333333, 5, 1,  40},
		{-1329910.6666666666, 5, 1,  50},
		{-3744894.0000000000, 5, 1,  60},
		{-8812877.3333333333, 5, 1,  70},
		{-18283860.666666666, 5, 1,  80},
		{-34547844.000000000, 5, 1,  90},
		{-60734827.333333333, 5, 1, 100},

		{ 21.000000000000000, 5, 2,   0},
		{ 4.3333333333333333, 5, 2,  10},
		{-1679.0000000000000, 5, 2,  20},
		{-46029.000000000000, 5, 2,  30},
		{-304045.66666666666, 5, 2,  40},
		{-1176729.0000000000, 5, 2,  50},
		{-3395079.0000000000, 5, 2,  60},
		{-8120095.6666666666, 5, 2,  70},
		{-17042779.000000000, 5, 2,  80},
		{-32484129.000000000, 5, 2,  90},
		{-57495145.666666666, 5, 2, 100},

		{ 252.00000000000000, 5, 5,   0},
		{-14.666666666666666, 5, 5,  10},
		{ 52.000000000000000, 5, 5,  20},
		{-19548.000000000000, 5, 5,  30},
		{-178814.66666666666, 5, 5,  40},
		{-797748.00000000000, 5, 5,  50},
		{-2496348.0000000000, 5, 5,  60},
		{-6294614.6666666666, 5, 5,  70},
		{-13712548.000000000, 5, 5,  80},
		{-26870148.000000000, 5, 5,  90},
		{-48587414.666666666, 5, 5, 100},

		{ 3003.0000000000000, 5, 10,   0},
		{ 19.666666666666666, 5, 10,  10},
		{ 36.333333333333333, 5, 10,  20},
		{-1947.0000000000000, 5, 10,  30},
		{-60930.333333333333, 5, 10,  40},
		{-381913.66666666666, 5, 10,  50},
		{-1419897.0000000000, 5, 10,  60},
		{-3979880.3333333333, 5, 10,  70},
		{-9316863.6666666666, 5, 10,  80},
		{-19235847.000000000, 5, 10,  90},
		{-36191830.333333333, 5, 10, 100},

		{ 53130.000000000000, 5, 20,   0},
		{ 1213.3333333333333, 5, 20,  10},
		{ 130.00000000000000, 5, 20,  20},
		{-120.00000000000000, 5, 20,  30},
		{ 463.33333333333333, 5, 20,  40},
		{-48120.000000000000, 5, 20,  50},
		{-345870.00000000000, 5, 20,  60},
		{-1342786.6666666666, 5, 20,  70},
		{-3838870.0000000000, 5, 20,  80},
		{-9084120.0000000000, 5, 20,  90},
		{-18878536.666666666, 5, 20, 100},

		{ 3478761.0000000000, 5, 50,   0},
		{ 1154544.3333333333, 5, 50,  10},
		{ 264661.00000000000, 5, 50,  20},
		{ 24111.000000000000, 5, 50,  30},
		{-2105.6666666666666, 5, 50,  40},
		{ 1011.0000000000000, 5, 50,  50},
		{-1539.0000000000000, 5, 50,  60},
		{ 5244.3333333333333, 5, 50,  70},
		{-13639.000000000000, 5, 50,  80},
		{-243189.00000000000, 5, 50,  90},
		{-1118405.6666666666, 5, 50, 100},

		{ 96560646.000000000, 5, 100,   0},
		{ 57264262.666666666, 5, 100,  10},
		{ 31841379.333333333, 5, 100,  20},
		{ 16281996.000000000, 5, 100,  30},
		{ 7426112.6666666666, 5, 100,  40},
		{ 2863729.3333333333, 5, 100,  50},
		{ 834846.00000000000, 5, 100,  60},
		{ 129462.66666666666, 5, 100,  70},
		{-12420.666666666666, 5, 100,  80},
		{-804.00000000000000, 5, 100,  90},
		{ 4312.6666666666666, 5, 100, 100},

		{ 1.0000000000000000, 10, 0,   0},
		{ 27.984126984126977, 10, 0,  10},
		{ 3227.8077601410932, 10, 0,  20},
		{ 15129.571428571455, 10, 0,  30},
		{ 79724066.608465582, 10, 0,  40},
		{ 2037190065.3738980, 10, 0,  50},
		{ 21804200401.000000, 10, 0,  60},
		{ 144688291819.51855, 10, 0,  70},
		{ 703324772760.08276, 10, 0,  80},
		{ 2741055412243.8569, 10, 0,  90},
		{ 9051283795429.5723, 10, 0, 100},

		{ 11.000000000000000, 10, 1,   0},
		{ 14.791887125220455, 10, 1,  10},
		{ 2704.6507936507933, 10, 1,  20},
		{-182924.71428571423, 10, 1,  30},
		{ 48066036.749559075, 10, 1,  40},
		{ 1486264192.2169311, 10, 1,  50},
		{ 17239562282.428574, 10, 1,  60},
		{ 119837491630.13579, 10, 1,  70},
		{ 600681375251.21167, 10, 1,  80},
		{ 2392908405632.4287, 10, 1,  90},
		{ 8033035722509.2373, 10, 1, 100},

		{ 66.000000000000000, 10, 2,   0},
		{-14.511463844797181, 10, 2,  10},
		{ 1064.5890652557316, 10, 2,  20},
		{-194569.71428571429, 10, 2,  30},
		{ 27343569.350970022, 10, 2,  40},
		{ 1067807661.6790125, 10, 2,  50},
		{ 13529451580.285711, 10, 2,  60},
		{ 98812724224.641937, 10, 2,  70},
		{ 511482736187.34021, 10, 2,  80},
		{ 2084478393087.4285, 10, 2,  90},
		{ 7117724862237.0752, 10, 2, 100},

		{ 3003.0000000000000, 10, 5,   0},
		{ 11.641975308642031, 10, 5,  10},
		{-1137.5643738977069, 10, 5,  20},
		{-9254.1428571428605, 10, 5,  30},
		{ 2121878.8377425023, 10, 5,  40},
		{ 352060171.43033499, 10, 5,  50},
		{ 6212028560.1428576, 10, 5,  60},
		{ 53782171674.604919, 10, 5,  70},
		{ 309720255837.56775, 10, 5,  80},
		{ 1359043035731.5713, 10, 5,  90},
		{ 4900625954398.9434, 10, 5, 100},

		{ 184756.00000000000, 10, 10,   0},
		{-210.84303350970018, 10, 10,  10},
		{ 508.38095238095184, 10, 10,  20},
		{ 2098.8571428571431, 10, 10,  30},
		{-536338.88536155177, 10, 10,  40},
		{ 24865988.804232784, 10, 10,  50},
		{ 1343756013.1428571, 10, 10,  60},
		{ 17298791247.358025, 10, 10,  70},
		{ 124528450897.79892, 10, 10,  80},
		{ 632674413641.71423, 10, 10,  90},
		{ 2533008935405.0298, 10, 10, 100},

		{ 30045014.999999993, 10, 20,   0},
		{-23087.733686067022, 10, 20,  10},
		{ 207.23985890652330, 10, 20,  20},
		{ 1407.8571428571508, 10, 20,  30},
		{-44618.156966490322, 10, 20,  40},
		{ 158690.04409171100, 10, 20,  50},
		{-6870413.5714285728, 10, 20,  60},
		{ 793841351.41975331, 10, 20,  70},
		{ 13358288958.562618, 10, 20,  80},
		{ 106073722407.85715, 10, 20,  90},
		{ 566337213392.42493, 10, 20, 100},

		{ 75394027566.000000, 10, 50,   0},
		{ 8048106183.3721361, 10, 50,  10},
		{ 328045023.84832460, 10, 50,  20},
		{-2568769.7142857178, 10, 50,  30},
		{ 6971.9964726631533, 10, 50,  40},
		{ 136111.41446207993, 10, 50,  50},
		{-62462.571428570242, 10, 50,  60},
		{-248167.95061728527, 10, 50,  70},
		{ 1941270.4091710770, 10, 50,  80},
		{-8643512.5714285765, 10, 50,  90},
		{-140863522.18342152, 10, 50, 100},

		{ 46897636623981.000, 10, 100,   0},
		{ 16444031323272.084, 10, 100,  10},
		{ 5020343986463.5391, 10, 100,  20},
		{ 1270977490645.2859, 10, 100,  30},
		{ 244835756822.62262, 10, 100,  40},
		{ 29786827693.962959, 10, 100,  50},
		{ 1127612095.2857144, 10, 100,  60},
		{-66370555.419753075, 10, 100,  70},
		{ 10420852.957671870, 10, 100,  80},
		{-3373097.5714285718, 10, 100,  90},
		{ 2065423.6807760145, 10, 100, 100},

		{ 1.0000000000000000, 20, 0,   0},
		{-11.961333867812119, 20, 0,  10},
		{ 2829.4728613531743, 20, 0,  20},
		{-18439.424502520938, 20, 0,  30},
		{ 24799805.877530713, 20, 0,  40},
		{ 7551960453.7672548, 20, 0,  50},
		{-1379223608444.9155, 20, 0,  60},
		{ 165423821874449.94, 20, 0,  70},
		{ 29500368536981676., 20, 0,  80},
		{ 1.1292309514432901e+18, 20, 0,  90},
		{ 2.2061882785931735e+19, 20, 0, 100},

		{ 21.000000000000000, 20, 1,   0},
		{ 19.900488129734079, 20, 1,  10},
		{ 2208.0318569557585, 20, 1,  20},
		{ 263690.96303121914, 20, 1,  30},
		{ 40667285.630564235, 20, 1,  40},
		{ 1737442572.8115399, 20, 1,  50},
		{-588280953643.28125, 20, 1,  60},
		{ 45617733778241.328, 20, 1,  70},
		{ 17293487114876864., 20, 1,  80},
		{ 7.6219135858585062e+17, 20, 1,  90},
		{ 1.6037288204336759e+19, 20, 1, 100},

		{ 231.00000000000003, 20, 2,   0},
		{ 47.009338065112921, 20, 2,  10},
		{-652.51305461728589, 20, 2,  20},
		{ 285388.25895069109, 20, 2,  30},
		{ 28664069.685624730, 20, 2,  40},
		{-1399631966.3144732, 20, 2,  50},
		{-115357373248.28194, 20, 2,  60},
		{-3357730872975.8750, 20, 2,  70},
		{ 9765808962855122.0, 20, 2,  80},
		{ 5.0717292945559181e+17, 20, 2,  90},
		{ 1.1564665701334456e+19, 20, 2, 100},

		{ 53130.000000000000, 20, 5,   0},
		{-158.69554500944142, 20, 5,  10},
		{ 334.08012288038952, 20, 5,  20},
		{-198372.47662554163, 20, 5,  30},
		{-13627144.088579426, 20, 5,  40},
		{-780579985.44731510, 20, 5,  50},
		{ 116648634237.73535, 20, 5,  60},
		{-12347348707739.742, 20, 5,  70},
		{ 1199516248034090.8, 20, 5,  80},
		{ 1.3451503195078531e+17, 20, 5,  90},
		{ 4.1058904276111483e+18, 20, 5, 100},

		{ 30045015.000000000, 20, 10,   0},
		{-1755.6226861258601, 20, 10,  10},
		{-9081.6726644737901, 20, 10,  20},
		{ 95771.650912113109, 20, 10,  30},
		{ 5089151.9272779236, 20, 10,  40},
		{ 97400399.450206712, 20, 10,  50},
		{-16009352450.477026, 20, 10,  60},
		{ 842271286905.01050, 20, 10,  70},
		{-79901725466796.938, 20, 10,  80},
		{ 7944103675858637.0, 20, 10,  90},
		{ 5.7429821893388288e+17, 20, 10, 100},

		{ 137846528819.99994, 20, 20,   0},
		{-136976.49571333229, 20, 20,  10},
		{ 113878.49908041643, 20, 20,  20},
		{-342529.21778796182, 20, 20,  30},
		{-350112.66981443466, 20, 20,  40},
		{-10791735.172977809, 20, 20,  50},
		{-1038073940.0811402, 20, 20,  60},
		{ 667312550.63616335, 20, 20,  70},
		{ 741537869902.29028, 20, 20,  80},
		{-32378376755737.418, 20, 20,  90},
		{-601760332167937.62, 20, 20, 100},

		{ 1.6188460366265789e+17, 20, 50,   0},
		{ 1599011936804291.5, 20, 50,  10},
		{-131273880831.42432, 20, 50,  20},
		{-3133213093.6903548, 20, 50,  30},
		{-213935628.04985175, 20, 50,  40},
		{-47375578.495921060, 20, 50,  50},
		{-115731015.14034876, 20, 50,  60},
		{-737415147.29420292, 20, 50,  70},
		{-2123455626.8621769, 20, 50,  80},
		{ 29801266858.608929, 20, 50,  90},
		{-132886631026.82553, 20, 50, 100},

		{ 2.9462227291176643e+22, 20, 100,   0},
		{ 3.5777890748701244e+21, 20, 100,  10},
		{ 3.1584925521456759e+20, 20, 100,  20},
		{ 1.7389599388424864e+19, 20, 100,  30},
		{ 4.1401342745980634e+17, 20, 100,  40},
		{-79359706102062.594, 20, 100,  50},
		{ 22736203650743.145, 20, 100,  60},
		{ 65679006380.095703, 20, 100,  70},
		{-236263257610.77792, 20, 100,  80},
		{-38072644585.303101, 20, 100,  90},
		{ 68236474365.173973, 20, 100, 100},

		{ 1.0000000000000000, 50, 0,   0},
		{ 17.534183446338233, 50, 0,  10},
		{ 980.26961889791028, 50, 0,  20},
		{ 293000.50735962362, 50, 0,  30},
		{-14896937.968694873, 50, 0,  40},
		{ 2513677852.6916871, 50, 0,  50},
		{-883876565337.99219, 50, 0,  60},
		{-80967880733583.234, 50, 0,  70},
		{-8217471769564841.0, 50, 0,  80},
		{-2.1140031308048891e+18, 50, 0,  90},
		{-3.9710103487094692e+20, 50, 0, 100},

		{ 51.000000000000021, 50, 1,   0},
		{ 1.4214573271639575, 50, 1,  10},
		{-2574.8072295127827, 50, 1,  20},
		{ 35846.479728359205, 50, 1,  30},
		{-48263698.768318526, 50, 1,  40},
		{ 6161525870.2738533, 50, 1,  50},
		{-382655486658.47125, 50, 1,  60},
		{-109635579833241.72, 50, 1,  70},
		{-14623805817283490., 50, 1,  80},
		{-2.0666847190878152e+18, 50, 1,  90},
		{-1.4385187953997626e+20, 50, 1, 100},

		{ 1326.0000000000000, 50, 2,   0},
		{-87.860732516444529, 50, 2,  10},
		{-5203.2351191780917, 50, 2,  20},
		{-461059.50012538867, 50, 2,  30},
		{-30476695.327440590, 50, 2,  40},
		{ 3720804977.9338136, 50, 2,  50},
		{ 362262002434.51453, 50, 2,  60},
		{-52210917867820.227, 50, 2,  70},
		{-9567965136901914.0, 50, 2,  80},
		{-8.9171277517712883e+17, 50, 2,  90},
		{ 5.7231129448806982e+19, 50, 2, 100},

		{ 3478761.0000000000, 50, 5,   0},
		{ 1055.8381917651498, 50, 5,  10},
		{ 15264.646660345055, 50, 5,  20},
		{ 1229651.8966600848, 50, 5,  30},
		{ 39270451.823656842, 50, 5,  40},
		{-4424062601.1152029, 50, 5,  50},
		{-186017434284.19223, 50, 5,  60},
		{ 50972853949302.609, 50, 5,  70},
		{ 6530702754012517.0, 50, 5,  80},
		{ 6.8387592714678029e+17, 50, 5,  90},
		{ 3.9198742504338391e+19, 50, 5, 100},

		{ 75394027565.999985, 50, 10,   0},
		{ 91833.924098770178, 50, 10,  10},
		{ 330501.87929778261, 50, 10,  20},
		{ 3625088.1635972536, 50, 10,  30},
		{ 213954727.28632012, 50, 10,  40},
		{-9381006937.7517681, 50, 10,  50},
		{ 535333683777.48615, 50, 10,  60},
		{ 18824406573722.172, 50, 10,  70},
		{-533858276780013.12, 50, 10,  80},
		{-52995774666704016., 50, 10,  90},
		{ 6.0504182862448783e+18, 50, 10, 100},

		{ 1.6188460366265779e+17, 50, 20,   0},
		{-307637087.25169408, 50, 20,  10},
		{ 12524651.102974586, 50, 20,  20},
		{-315460483.86210561, 50, 20,  30},
		{-1889683587.3459988, 50, 20,  40},
		{ 37457044404.200348, 50, 20,  50},
		{-843831858224.71802, 50, 20,  60},
		{-92231643172.307495, 50, 20,  70},
		{ 904211757769501.00, 50, 20,  80},
		{ 46508193600283272., 50, 20,  90},
		{ 2.3216887928162719e+18, 50, 20, 100},

		{ 1.0089134454556417e+29, 50, 50,   0},
		{ 1.3822795753070493e+23, 50, 50,  10},
		{ 95817260381628336., 50, 50,  20},
		{-910798580856015.38, 50, 50,  30},
		{ 50513254049166.922, 50, 50,  40},
		{ 84159703903348.938, 50, 50,  50},
		{-138805244691822.72, 50, 50,  60},
		{ 181046391269246.25, 50, 50,  70},
		{ 2086884905317107.5, 50, 50,  80},
		{-2765620139862428.0, 50, 50,  90},
		{-1.3706751678146290e+17, 50, 50, 100},

		{ 2.0128660909731929e+40, 50, 100,   0},
//		{ 9.3675094807695474e+37, 50, 100,  10},
		{ 1.3009321481877196e+35, 50, 100,  20},
		{ 7.3720026893233823e+30, 50, 100,  30},
		{-6.0824679079634667e+25, 50, 100,  40},
		{-6.0053188793543450e+23, 50, 100,  50},
		{ 1.4178129287264692e+22, 50, 100,  60},
		{-5.4652099341566706e+20, 50, 100,  70},
		{-1.0817271759263274e+20, 50, 100,  80},
		{ 3.8058734007924195e+19, 50, 100,  90},
		{ 4.7439240848028344e+19, 50, 100, 100},

		{ 1.0000000000000000, 100, 0,   0},
		{ 13.277662844303450, 100, 0,  10},
		{ 1854.0367283243388, 100, 0,  20},
		{ 170141.86987046551, 100, 0,  30},
		{-7272442.3156006960, 100, 0,  40},
		{ 4847420871.2690506, 100, 0,  50},
		{ 693492765740.29688, 100, 0,  60},
		{ 17125518672239.770, 100, 0,  70},
		{-13763178176383768., 100, 0,  80},
		{ 2.1307220490380173e+18, 100, 0,  90},
		{-2.6292260693068916e+20, 100, 0, 100},

		{ 101.00000000000003, 100, 1,   0},
		{-14.650661983680420, 100, 1,  10},
		{ 1626.5010939361582, 100, 1,  20},
		{ 417884.77658268728, 100, 1,  30},
		{-55617646.951649837, 100, 1,  40},
		{ 884829874.26626217, 100, 1,  50},
		{ 154466082750.32202, 100, 1,  60},
		{-101423973484646.00, 100, 1,  70},
		{-1388352348671756.8, 100, 1,  80},
		{ 7.8048705513268582e+17, 100, 1,  90},
		{ 1.6948925059042755e+19, 100, 1, 100},

		{ 5151.0000000000055, 100, 2,   0},
		{-150.22012290951324, 100, 2,  10},
		{-7655.0593294049449, 100, 2,  20},
		{-140996.69276179091, 100, 2,  30},
		{-38645171.278549351, 100, 2,  40},
		{-8889263688.2118931, 100, 2,  50},
		{-1010338971533.3400, 100, 2,  60},
		{-127582564332943.91, 100, 2,  70},
		{ 15970305694654312., 100, 2,  80},
		{-1.6019844992862820e+18, 100, 2,  90},
		{ 2.8267024730962955e+20, 100, 2, 100},

		{ 96560646.000000030, 100, 5,   0},
		{ 2430.6732236677612, 100, 5,  10},
		{ 111162.32026994647, 100, 5,  20},
		{ 4036708.2599413628, 100, 5,  30},
		{-34055982.664405443, 100, 5,  40},
		{ 30110688343.562328, 100, 5,  50},
		{ 2651429940558.2974, 100, 5,  60},
		{ 192108556058943.09, 100, 5,  70},
		{-25410533973455528., 100, 5,  80},
		{ 2.1072955633564431e+18, 100, 5,  90},
		{-2.9434005355877289e+20, 100, 5, 100},

		{ 46897636623981.039, 100, 10,   0},
		{ 529208.11550990329, 100, 10,  10},
		{ 7402892.1748803817, 100, 10,  20},
		{ 88369632.083243579, 100, 10,  30},
		{ 822187797.59096563, 100, 10,  40},
		{ 180231446033.06866, 100, 10,  50},
		{ 7922942703798.1309, 100, 10,  60},
		{ 784424250559042.12, 100, 10,  70},
		{-16325634720239370., 100, 10,  80},
		{-1.0879588307443162e+18, 100, 10,  90},
		{ 3.0114394463610642e+19, 100, 10, 100},

		{ 2.9462227291176614e+22, 100, 20,   0},
		{ 313694958939.90405, 100, 20,  10},
		{ 45396489338.096191, 100, 20,  20},
		{-7215826758.0081253, 100, 20,  30},
		{ 825949194005.88855, 100, 20,  40},
		{-2764742119971.0811, 100, 20,  50},
		{-219802198273516.03, 100, 20,  60},
		{-1699053306145262.0, 100, 20,  70},
		{ 3.5495709345023846e+17, 100, 20,  80},
		{-9.6128675110292419e+18, 100, 20,  90},
		{ 4.3619868422072212e+20, 100, 20, 100},

		{ 2.0128660909731931e+40, 100, 50,   0},
		{-4.0151443913473373e+28, 100, 50,  10},
		{ 3.2199632594551924e+22, 100, 50,  20},
		{-2.7568702092659756e+20, 100, 50,  30},
		{ 7.5553066015421563e+19, 100, 50,  40},
		{-2.7651625252387734e+19, 100, 50,  50},
		{-5.8963680147283804e+19, 100, 50,  60},
		{-1.8082798163033106e+20, 100, 50,  70},
		{-3.9044276986817249e+20, 100, 50,  80},
		{ 6.9926310700401904e+21, 100, 50,  90},
		{-5.5727272809923646e+22, 100, 50, 100},

		{ 9.0548514656103225e+58, 100, 100,   0},
		{ 1.3334078033060556e+54, 100, 100,  10},
		{ 2.1002639254211340e+46, 100, 100,  20},
		{-1.1073158068796292e+39, 100, 100,  30},
		{-8.3640937363981346e+35, 100, 100,  40},
		{-6.5879339429312686e+32, 100, 100,  50},
		{-2.4190645077698771e+30, 100, 100,  60},
		{-7.9224960465662171e+29, 100, 100,  70},
		{-2.8605772478408694e+29, 100, 100,  80},
		{ 2.4149589189609957e+28, 100, 100,  90},
		{ 5.1146476014859021e+28, 100, 100, 100},
	};

	for (auto const& data : testcases)
	{
		auto const r = hamon::assoc_laguerre(data.n, data.m, data.x);

		if (data.expected > max)
		{
			if (!hamon::isnan(r))
			{
				EXPECT_EQ(+inf, r);
			}
		}
		else if (data.expected < min)
		{
			if (!hamon::isnan(r))
			{
				EXPECT_EQ(-inf, r);
			}
		}
		else
		{
			double tole = hamon::abs(data.expected) * error;
			EXPECT_NEAR(data.expected, (double)r, tole);
		}
	}
}

GTEST_TEST(CMathTest, AssocLaguerreTest)
{
	AssocLaguerreTest<float>      (0.0001);
	AssocLaguerreTest<double>     (0.000000000001);
	AssocLaguerreTest<long double>(0.000000000001);
	AssocLaguerreTest<int>        (0.000000000001);

	HAMON_CXX11_CONSTEXPR auto nanf = std::numeric_limits<float>::quiet_NaN();
	HAMON_CXX14_CONSTEXPR_EXPECT_TRUE(hamon::isnan(hamon::assoc_laguerref(0, 0, nanf)));
	HAMON_CXX14_CONSTEXPR_EXPECT_TRUE(hamon::isnan(hamon::assoc_laguerref(1, 1, nanf)));
	HAMON_CXX14_CONSTEXPR_EXPECT_TRUE(hamon::isnan(hamon::assoc_laguerref(0, 2, -1.0f)));
	HAMON_CXX14_CONSTEXPR_EXPECT_TRUE(hamon::isnan(hamon::assoc_laguerref(1, 3, -1.0f)));

	HAMON_CXX11_CONSTEXPR auto nanl = std::numeric_limits<long double>::quiet_NaN();
	HAMON_CXX14_CONSTEXPR_EXPECT_TRUE(hamon::isnan(hamon::assoc_laguerrel(0, 0, nanl)));
	HAMON_CXX14_CONSTEXPR_EXPECT_TRUE(hamon::isnan(hamon::assoc_laguerrel(1, 1, nanl)));
	HAMON_CXX14_CONSTEXPR_EXPECT_TRUE(hamon::isnan(hamon::assoc_laguerrel(0, 2, -1.0l)));
	HAMON_CXX14_CONSTEXPR_EXPECT_TRUE(hamon::isnan(hamon::assoc_laguerrel(1, 3, -1.0l)));
}

}	// namespace assoc_laguerre_test

}	// namespace hamon_cmath_test
