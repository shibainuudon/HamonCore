/**
 *	@file	unit_test_cmath_cyl_bessel_i.cpp
 *
 *	@brief	cyl_bessel_i のテスト
 */

#include <hamon/cmath/cyl_bessel_i.hpp>
#include <hamon/cmath/isnan.hpp>
#include <hamon/cmath/abs.hpp>
#include <hamon/type_traits/is_same.hpp>
#include <hamon/limits.hpp>
#include <gtest/gtest.h>
#include "constexpr_test.hpp"

namespace hamon_cmath_test
{

namespace cyl_bessel_i_test
{

static_assert(hamon::is_same<float,       decltype(hamon::cyl_bessel_i(0.0f, 0.0f))>::value, "");
static_assert(hamon::is_same<double,      decltype(hamon::cyl_bessel_i(0.0f, 0.0 ))>::value, "");
static_assert(hamon::is_same<long double, decltype(hamon::cyl_bessel_i(0.0f, 0.0l))>::value, "");
static_assert(hamon::is_same<double,      decltype(hamon::cyl_bessel_i(0.0f, 0   ))>::value, "");
static_assert(hamon::is_same<double,      decltype(hamon::cyl_bessel_i(0.0 , 0.0f))>::value, "");
static_assert(hamon::is_same<double,      decltype(hamon::cyl_bessel_i(0.0 , 0.0 ))>::value, "");
static_assert(hamon::is_same<long double, decltype(hamon::cyl_bessel_i(0.0 , 0.0l))>::value, "");
static_assert(hamon::is_same<double,      decltype(hamon::cyl_bessel_i(0.0 , 0   ))>::value, "");
static_assert(hamon::is_same<long double, decltype(hamon::cyl_bessel_i(0.0l, 0.0f))>::value, "");
static_assert(hamon::is_same<long double, decltype(hamon::cyl_bessel_i(0.0l, 0.0 ))>::value, "");
static_assert(hamon::is_same<long double, decltype(hamon::cyl_bessel_i(0.0l, 0.0l))>::value, "");
static_assert(hamon::is_same<long double, decltype(hamon::cyl_bessel_i(0.0l, 0   ))>::value, "");
static_assert(hamon::is_same<double,      decltype(hamon::cyl_bessel_i(0   , 0.0f))>::value, "");
static_assert(hamon::is_same<double,      decltype(hamon::cyl_bessel_i(0   , 0.0 ))>::value, "");
static_assert(hamon::is_same<long double, decltype(hamon::cyl_bessel_i(0   , 0.0l))>::value, "");
static_assert(hamon::is_same<double,      decltype(hamon::cyl_bessel_i(0   , 0   ))>::value, "");
static_assert(hamon::is_same<float,       decltype(hamon::cyl_bessel_if(0.0f, 0.0f))>::value, "");
static_assert(hamon::is_same<long double, decltype(hamon::cyl_bessel_il(0.0l, 0.0l))>::value, "");

template <typename T1, typename T2>
struct get_error
{
	static HAMON_CXX11_CONSTEXPR double get()
	{
		return 0.000000000001;
	}
};

template <typename T2>
struct get_error<float, T2>
{
	static HAMON_CXX11_CONSTEXPR double get()
	{
		return 0.0000001;
	}
};

template <typename T1, typename T2>
void CylBesselITestFloat()
{
	using Promoted = hamon::float_promote_t<T1, T2>;
	HAMON_CXX11_CONSTEXPR auto nan1   = hamon::numeric_limits<T1>::quiet_NaN();
	HAMON_CXX11_CONSTEXPR auto nan2   = hamon::numeric_limits<T2>::quiet_NaN();
	HAMON_CXX11_CONSTEXPR auto inf    = hamon::numeric_limits<Promoted>::infinity();
	HAMON_CXX11_CONSTEXPR auto lowest = hamon::numeric_limits<Promoted>::lowest();
	HAMON_CXX11_CONSTEXPR auto max    = hamon::numeric_limits<Promoted>::max();
	HAMON_CXX11_CONSTEXPR auto min    = hamon::numeric_limits<Promoted>::min();

	HAMON_CXX11_CONSTEXPR double error = get_error<T1, T2>::get();

	HAMON_CXX14_CONSTEXPR_EXPECT_TRUE(hamon::isnan(hamon::cyl_bessel_i(nan1, nan2)));
	HAMON_CXX14_CONSTEXPR_EXPECT_TRUE(hamon::isnan(hamon::cyl_bessel_i(nan1, T2(0))));
	HAMON_CXX14_CONSTEXPR_EXPECT_TRUE(hamon::isnan(hamon::cyl_bessel_i(T1(0), nan2)));

	// TODO
//	HAMON_CXX14_CONSTEXPR_EXPECT_NEAR( 1.0000000000000000, (double)hamon::cyl_bessel_i(T1(0.0), T2(0.0)), error);
//	HAMON_CXX14_CONSTEXPR_EXPECT_NEAR(11.301921952136325,  (double)hamon::cyl_bessel_i(T1(0.0), T2(4.0)), error);

	struct testcase
	{
		double expected;
		T1 nu;
		T2 x;
	};

	static testcase const testcases[] =
	{
		{1.0000000000000000, 0.0, 0.00},
		{1.0156861412236078, 0.0, 0.25},
		{1.0634833707413236, 0.0, 0.50},
		{1.1456467780440014, 0.0, 0.75},
		{1.2660658777520082, 0.0, 1.00},
		{1.4304687177218294, 0.0, 1.25},
		{1.6467231897728904, 0.0, 1.50},
		{1.9252521538585021, 0.0, 1.75},
		{2.2795853023360668, 0.0, 2.00},
		{2.7270783071907951, 0.0, 2.25},
		{3.2898391440501231, 0.0, 2.50},
		{3.9959131072376550, 0.0, 2.75},
		{4.8807925858650245, 0.0, 3.00},
		{5.9893359979395138, 0.0, 3.25},
		{7.3782034322254750, 0.0, 3.50},
		{9.1189458608445655, 0.0, 3.75},
		{11.301921952136325, 0.0, 4.00},
		{14.041263683000595, 0.0, 4.25},
		{17.481171855609272, 0.0, 4.50},
		{21.803898740902120, 0.0, 4.75},
		{27.239871823604439, 0.0, 5.00},

		{0.0000000000000000, T1(0.3333333333333333), 0.00},
		{0.5665068655780866, T1(0.3333333333333333), 0.25},
		{0.7389731564251186, T1(0.3333333333333333), 0.50},
		{0.8953232036583681, T1(0.3333333333333333), 0.75},
		{1.0646313978895283, T1(0.3333333333333333), 1.00},
		{1.2623776732605250, T1(0.3333333333333333), 1.25},
		{1.5014290000224382, T1(0.3333333333333333), 1.50},
		{1.7951195525946040, T1(0.3333333333333333), 1.75},
		{2.1587825813728614, T1(0.3333333333333333), 2.00},
		{2.6109134564811405, T1(0.3333333333333333), 2.25},
		{3.1743242297241938, T1(0.3333333333333333), 2.50},
		{3.8774551722182093, T1(0.3333333333333333), 2.75},
		{4.7559569371646946, T1(0.3333333333333333), 3.00},
		{5.8546499652731825, T1(0.3333333333333333), 3.25},
		{7.2299798619171129, T1(0.3333333333333333), 3.50},
		{8.9531114355506318, T1(0.3333333333333333), 3.75},
		{11.113838389991479, T1(0.3333333333333333), 4.00},
		{13.825531136529117, T1(0.3333333333333333), 4.25},
		{17.231403968478318, T1(0.3333333333333333), 4.50},
		{21.512458099556554, T1(0.3333333333333333), 4.75},
		{26.897553069268362, T1(0.3333333333333333), 5.00},

		{0.0000000000000000, 0.5, 0.00},
		{0.4031109348997589, 0.5, 0.25},
		{0.5879930867904157, 0.5, 0.50},
		{0.7576149863899129, 0.5, 0.75},
		{0.9376748882454869, 0.5, 1.00},
		{1.1432089853159872, 0.5, 1.25},
		{1.3871617204034761, 0.5, 1.50},
		{1.6830217804556813, 0.5, 1.75},
		{2.0462368630890526, 0.5, 2.00},
		{2.4953405089360046, 0.5, 2.25},
		{3.0530935381967175, 0.5, 2.50},
		{3.7477882494879449, 0.5, 2.75},
		{4.6148229034075969, 0.5, 3.00},
		{5.6986505325335486, 0.5, 3.25},
		{7.0552194086911859, 0.5, 3.50},
		{8.7550467841188979, 0.5, 3.75},
		{10.887101798588422, 0.5, 4.00},
		{13.563718712579764, 0.5, 4.25},
		{16.926820080158183, 0.5, 4.50},
		{21.155804306570005, 0.5, 4.75},
		{26.477547497559065, 0.5, 5.00},

		{0.0000000000000000, T1(0.6666666666666666), 0.00},
		{0.2795369061320044, T1(0.6666666666666666), 0.25},
		{0.4562832311355689, T1(0.6666666666666666), 0.50},
		{0.6259456983818262, T1(0.6666666666666666), 0.75},
		{0.8075212886061297, T1(0.6666666666666666), 1.00},
		{1.0139484513577173, T1(0.6666666666666666), 1.25},
		{1.2572918396962993, T1(0.6666666666666666), 1.50},
		{1.5505806938325581, T1(0.6666666666666666), 1.75},
		{1.9089492968236210, T1(0.6666666666666666), 2.00},
		{2.3506463490300340, T1(0.6666666666666666), 2.25},
		{2.8981161894224896, T1(0.6666666666666666), 2.50},
		{3.5792654911068724, T1(0.6666666666666666), 2.75},
		{4.4290087213549514, T1(0.6666666666666666), 3.00},
		{5.4911895720097705, T1(0.6666666666666666), 3.25},
		{6.8209918044137305, T1(0.6666666666666666), 3.50},
		{8.4879784249619785, T1(0.6666666666666666), 3.75},
		{10.579932774013004, T1(0.6666666666666666), 4.00},
		{13.207720355482458, T1(0.6666666666666666), 4.25},
		{16.511448404200543, T1(0.6666666666666666), 4.50},
		{20.668274532832392, T1(0.6666666666666666), 4.75},
		{25.902310583215122, T1(0.6666666666666666), 5.00},

		{0.0000000000000000, 1.0, 0.00},
		{0.1259791089454679, 1.0, 0.25},
		{0.2578943053908963, 1.0, 0.50},
		{0.4019924615809222, 1.0, 0.75},
		{0.5651591039924850, 1.0, 1.00},
		{0.7552814183407472, 1.0, 1.25},
		{0.9816664285779072, 1.0, 1.50},
		{1.2555375122401728, 1.0, 1.75},
		{1.5906368546373291, 1.0, 2.00},
		{2.0039674569295931, 1.0, 2.25},
		{2.5167162452886984, 1.0, 2.50},
		{3.1554101386190028, 1.0, 2.75},
		{3.9533702174026097, 1.0, 3.00},
		{4.9525461659085490, 1.0, 3.25},
		{6.2058349222583642, 1.0, 3.50},
		{7.7800152298244170, 1.0, 3.75},
		{9.7594651537044523, 1.0, 4.00},
		{12.250874667409304, 1.0, 4.25},
		{15.389222753735924, 1.0, 4.50},
		{19.345361447520226, 1.0, 4.75},
		{24.335642142450524, 1.0, 5.00},

		{0.0000000000000000,    2.0, 0.00},
		{0.0078532696598645167, 2.0, 0.25},
		{0.031906149177738249,  2.0, 0.50},
		{0.073666880494875436,  2.0, 0.75},
		{0.13574766976703831,   2.0, 1.00},
		{0.22201844837663415,   2.0, 1.25},
		{0.33783461833568068,   2.0, 1.50},
		{0.49035213986973314,   2.0, 1.75},
		{0.68894844769873831,   2.0, 2.00},
		{0.94577390103115722,   2.0, 2.25},
		{1.2764661478191643,    2.0, 2.50},
		{1.7010693700601991,    2.0, 2.75},
		{2.2452124409299512,    2.0, 3.00},
		{2.9416152804573357,    2.0, 3.25},
		{3.8320120480778415,    2.0, 3.50},
		{4.9696044049382113,    2.0, 3.75},
		{6.4221893752841055,    2.0, 4.00},
		{8.2761461924550552,    2.0, 4.25},
		{10.641517298393307,    2.0, 4.50},
		{13.658483394577813,    2.0, 4.75},
		{17.505614966624233,    2.0, 5.00},

		{0.0000000000000000,     5.0, 0.00},
		{2.5497616449882785e-07, 5.0, 0.25},
		{8.2231713131092646e-06, 5.0, 0.50},
		{6.3261122739811725e-05, 5.0, 0.75},
		{0.00027146315595697195, 5.0, 1.00},
		{0.00084793613616686856, 5.0, 1.25},
		{0.0021705595690975554,  5.0, 1.50},
		{0.0048504513371845385,  5.0, 1.75},
		{0.0098256793231317023,  5.0, 2.00},
		{0.018486577941045829,   5.0, 2.25},
		{0.032843475172023219,   5.0, 2.50},
		{0.055750882754221943,   5.0, 2.75},
		{0.091206477661513338,   5.0, 3.00},
		{0.14474880546308083,    5.0, 3.25},
		{0.22398495470190780,    5.0, 3.50},
		{0.33928899170999877,    5.0, 3.75},
		{0.50472436311316637,    5.0, 4.00},
		{0.73925961816682961,    5.0, 4.25},
		{1.0683677743764701,     5.0, 4.50},
		{1.5261268693599621,     5.0, 4.75},
		{2.1579745473225476,     5.0, 5.00},

		{0.0000000000000000,     10.0, 0.00},
		{2.5701232848571186e-16, 10.0, 0.25},
		{2.6430419258812784e-13, 10.0, 0.50},
		{1.5349659676120412e-11, 10.0, 0.75},
		{2.7529480398368732e-10, 10.0, 1.00},
		{2.5967897782035928e-09, 10.0, 1.25},
		{1.6330924437799743e-08, 10.0, 1.50},
		{7.7706676834614079e-08, 10.0, 1.75},
		{3.0169638793506839e-07, 10.0, 2.00},
		{1.0034459057774481e-06, 10.0, 2.25},
		{2.9557436109680578e-06, 10.0, 2.50},
		{7.8955603774082724e-06, 10.0, 2.75},
		{1.9464393470612970e-05, 10.0, 3.00},
		{4.4875369479742435e-05, 10.0, 3.25},
		{9.7760848514528916e-05, 10.0, 3.50},
		{0.00020289011210063496, 10.0, 3.75},
		{0.00040378896132693058, 10.0, 4.00},
		{0.00077478519551669892, 10.0, 4.25},
		{0.0014397060684919682,  10.0, 4.50},
		{0.0026004486016189452,  10.0, 4.75},
		{0.0045800444191760525,  10.0, 5.00},

		{0.0000000000000000,     20.0, 0.00},
		{3.5677858077910353e-37, 20.0, 0.25},
		{3.7494538480790194e-31, 20.0, 0.50},
		{1.2514356342425337e-27, 20.0, 0.75},
		{3.9668359858190197e-25, 20.0, 1.00},
		{3.4637832909868234e-23, 20.0, 1.25},
		{1.3388331839683472e-21, 20.0, 1.50},
		{2.9502376732679751e-20, 20.0, 1.75},
		{4.3105605761095479e-19, 20.0, 2.00},
		{4.6032451406433059e-18, 20.0, 2.25},
		{3.8400317244170310e-17, 20.0, 2.50},
		{2.6239115263043263e-16, 20.0, 2.75},
		{1.5209660019426689e-15, 20.0, 3.00},
		{7.6806450728249953e-15, 20.0, 3.25},
		{3.4495528847222945e-14, 20.0, 3.50},
		{1.4006589294850677e-13, 20.0, 3.75},
		{5.2100734221993054e-13, 20.0, 4.00},
		{1.7946903269488168e-12, 20.0, 4.25},
		{5.7763830562279699e-12, 20.0, 4.50},
		{1.7502433074548735e-11, 20.0, 4.75},
		{5.0242393579718066e-11, 20.0, 5.00},

		{1.0000000000000000,     0.0,   0.0},
		{27.239871823604439,     0.0,   5.0},
		{2815.7166284662558,     0.0,  10.0},
		{339649.37329791381,     0.0,  15.0},
		{43558282.559553474,     0.0,  20.0},
		{5774560606.4663124,     0.0,  25.0},
		{781672297823.97925,     0.0,  30.0},
		{107338818494514.42,     0.0,  35.0},
		{14894774793419916.,     0.0,  40.0},
		{2.0834140751773164e+18, 0.0,  45.0},
		{2.9325537838493457e+20, 0.0,  50.0},
		{4.1487895607332160e+22, 0.0,  55.0},
		{5.8940770556098216e+24, 0.0,  60.0},
		{8.4030398456255582e+26, 0.0,  65.0},
		{1.2015889579125424e+29, 0.0,  70.0},
		{1.7226390780357976e+31, 0.0,  75.0},
		{2.4751784043341661e+33, 0.0,  80.0},
		{3.5634776304081403e+35, 0.0,  85.0},
		{5.1392383455086475e+37, 0.0,  90.0},
		{7.4233258618752072e+39, 0.0,  95.0},
		{1.0737517071310986e+42, 0.0, 100.0},

		{0.0000000000000000,     T1(0.3333333333333333),   0.0},
		{26.897553069268362,     T1(0.3333333333333333),   5.0},
		{2799.2396097056790,     T1(0.3333333333333333),  10.0},
		{338348.63146593666,     T1(0.3333333333333333),  15.0},
		{43434263.927938424,     T1(0.3333333333333333),  20.0},
		{5761474759.6213636,     T1(0.3333333333333333),  25.0},
		{780201111830.30237,     T1(0.3333333333333333),  30.0},
		{107166066959051.91,     T1(0.3333333333333333),  35.0},
		{14873836574083762.,     T1(0.3333333333333333),  40.0},
		{2.0808143020217085e+18, T1(0.3333333333333333),  45.0},
		{2.9292639365644226e+20, T1(0.3333333333333333),  50.0},
		{4.1445621624120489e+22, T1(0.3333333333333333),  55.0},
		{5.8885758374365916e+24, T1(0.3333333333333333),  60.0},
		{8.3958047021083941e+26, T1(0.3333333333333333),  65.0},
		{1.2006287819446431e+29, T1(0.3333333333333333),  70.0},
		{1.7213548977150022e+31, T1(0.3333333333333333),  75.0},
		{2.4734492458444449e+33, T1(0.3333333333333333),  80.0},
		{3.5611354547857122e+35, T1(0.3333333333333333),  85.0},
		{5.1360491295551848e+37, T1(0.3333333333333333),  90.0},
		{7.4189629097600431e+39, T1(0.3333333333333333),  95.0},
		{1.0731523308358370e+42, T1(0.3333333333333333), 100.0},

		{0.0000000000000000,     0.5,   0.0},
		{26.477547497559065,     0.5,   5.0},
		{2778.7846038745711,     0.5,  10.0},
		{336729.88718706399,     0.5,  15.0},
		{43279746.272428922,     0.5,  20.0},
		{5745159748.3464680,     0.5,  25.0},
		{778366068840.44580,     0.5,  30.0},
		{106950522408567.66,     0.5,  35.0},
		{14847705549021960.,     0.5,  40.0},
		{2.0775691824625661e+18, 0.5,  45.0},
		{2.9251568529912984e+20, 0.5,  50.0},
		{4.1392840094781220e+22, 0.5,  55.0},
		{5.8817065760751945e+24, 0.5,  60.0},
		{8.3867695787277245e+26, 0.5,  65.0},
		{1.1994296461653203e+29, 0.5,  70.0},
		{1.7197510246063334e+31, 0.5,  75.0},
		{2.4712895036230794e+33, 0.5,  80.0},
		{3.5582099086757769e+35, 0.5,  85.0},
		{5.1320654031231128e+37, 0.5,  90.0},
		{7.4135128383495239e+39, 0.5,  95.0},
		{1.0724035825423179e+42, 0.5, 100.0},

		{0.0000000000000000,     T1(0.6666666666666666),   0.0},
		{25.902310583215122,     T1(0.6666666666666666),   5.0},
		{2750.4090423459315,     T1(0.6666666666666666),  10.0},
		{334476.98138574377,     T1(0.6666666666666666),  15.0},
		{43064361.686912313,     T1(0.6666666666666666),  20.0},
		{5722397441.9603882,     T1(0.6666666666666666),  25.0},
		{775804343498.02661,     T1(0.6666666666666666),  30.0},
		{106649495512800.88,     T1(0.6666666666666666),  35.0},
		{14811199896983754.,     T1(0.6666666666666666),  40.0},
		{2.0730345814356961e+18, T1(0.6666666666666666),  45.0},
		{2.9194166755257467e+20, T1(0.6666666666666666),  50.0},
		{4.1319059569935374e+22, T1(0.6666666666666666),  55.0},
		{5.8721031476386222e+24, T1(0.6666666666666666),  60.0},
		{8.3741368248217830e+26, T1(0.6666666666666666),  65.0},
		{1.1977528777008688e+29, T1(0.6666666666666666),  70.0},
		{1.7175081240014333e+31, T1(0.6666666666666666),  75.0},
		{2.4682690458513916e+33, T1(0.6666666666666666),  80.0},
		{3.5541181975850724e+35, T1(0.6666666666666666),  85.0},
		{5.1264933963228892e+37, T1(0.6666666666666666),  90.0},
		{7.4058894880134064e+39, T1(0.6666666666666666),  95.0},
		{1.0713562154788124e+42, T1(0.6666666666666666), 100.0},

		{0.0000000000000000,     1.0,   0.0},
		{24.335642142450524,     1.0,   5.0},
		{2670.9883037012560,     1.0,  10.0},
		{328124.92197020649,     1.0,  15.0},
		{42454973.385127783,     1.0,  20.0},
		{5657865129.8787022,     1.0,  25.0},
		{768532038938.95667,     1.0,  30.0},
		{105794126051896.17,     1.0,  35.0},
		{14707396163259352.,     1.0,  40.0},
		{2.0601334620815780e+18, 1.0,  45.0},
		{2.9030785901035638e+20, 1.0,  50.0},
		{4.1108986452992812e+22, 1.0,  55.0},
		{5.8447515883904527e+24, 1.0,  60.0},
		{8.3381485471501288e+26, 1.0,  65.0},
		{1.1929750788892366e+29, 1.0,  70.0},
		{1.7111160152965382e+31, 1.0,  75.0},
		{2.4596595795675343e+33, 1.0,  80.0},
		{3.5424536064404024e+35, 1.0,  85.0},
		{5.1106068152566129e+37, 1.0,  90.0},
		{7.3841518091360182e+39, 1.0,  95.0},
		{1.0683693903381569e+42, 1.0, 100.0},

		{0.0000000000000000,     2.0,   0.0},
		{17.505614966624233,     2.0,   5.0},
		{2281.5189677260046,     2.0,  10.0},
		{295899.38370188628,     2.0,  15.0},
		{39312785.221040756,     2.0,  20.0},
		{5321931396.0760155,     2.0,  25.0},
		{730436828561.38013,     2.0,  30.0},
		{101293439862977.19,     2.0,  35.0},
		{14159404985256920.,     2.0,  40.0},
		{1.9918525879736883e+18, 2.0,  45.0},
		{2.8164306402451938e+20, 2.0,  50.0},
		{3.9993023372677540e+22, 2.0,  55.0},
		{5.6992520026634433e+24, 2.0,  60.0},
		{8.1464814287900364e+26, 2.0,  65.0},
		{1.1675039556585663e+29, 2.0,  70.0},
		{1.6770093176278926e+31, 2.0,  75.0},
		{2.4136869148449879e+33, 2.0,  80.0},
		{3.4801257808448186e+35, 2.0,  85.0},
		{5.0256693051696307e+37, 2.0,  90.0},
		{7.2678700343145818e+39, 2.0,  95.0},
		{1.0523843193243042e+42, 2.0, 100.0},

		{0.0000000000000000,     5.0,   0.0},
		{2.1579745473225476,     5.0,   5.0},
		{777.18828640326012,     5.0,  10.0},
		{144572.01120063409,     5.0,  15.0},
		{23018392.213413671,     5.0,  20.0},
		{3472466208.7419176,     5.0,  25.0},
		{512151465476.93494,     5.0,  30.0},
		{74756743552251.547,     5.0,  35.0},
		{10858318337624278.,     5.0,  40.0},
		{1.5736087399245911e+18, 5.0,  45.0},
		{2.2785483079112825e+20, 5.0,  50.0},
		{3.2989391052963687e+22, 5.0,  55.0},
		{4.7777652072561732e+24, 5.0,  60.0},
		{6.9232165147172657e+26, 5.0,  65.0},
		{1.0038643002095155e+29, 5.0,  70.0},
		{1.4566328222327073e+31, 5.0,  75.0},
		{2.1151488565944835e+33, 5.0,  80.0},
		{3.0735883450768239e+35, 5.0,  85.0},
		{4.4694790189230327e+37, 5.0,  90.0},
		{6.5037505570430995e+39, 5.0,  95.0},
		{9.4700938730355882e+41, 5.0, 100.0},

		{0.0000000000000000,     10.0,   0.0},
		{0.0045800444191760525,  10.0,   5.0},
		{21.891706163723381,     10.0,  10.0},
		{12267.475049806462,     10.0,  15.0},
		{3540200.2090195213,     10.0,  20.0},
		{771298871.17072666,     10.0,  25.0},
		{145831809975.96710,     10.0,  30.0},
		{25449470018534.777,     10.0,  35.0},
		{4228469210516757.0,     10.0,  40.0},
		{6.8049404557505165e+17, 10.0,  45.0},
		{1.0715971594776370e+20, 10.0,  50.0},
		{1.6618215752886714e+22, 10.0,  55.0},
		{2.5486246072566784e+24, 10.0,  60.0},
		{3.8764628702155475e+26, 10.0,  65.0},
		{5.8592538145409686e+28, 10.0,  70.0},
		{8.8135370711317444e+30, 10.0,  75.0},
		{1.3207418268325279e+33, 10.0,  80.0},
		{1.9732791360862190e+35, 10.0,  85.0},
		{2.9411893748384672e+37, 10.0,  90.0},
		{4.3754494922439984e+39, 10.0,  95.0},
		{6.4989755247201446e+41, 10.0, 100.0},

		{0.0000000000000000,     20.0,   0.0},
		{5.0242393579718066e-11, 20.0,   5.0},
		{0.00012507997356449481, 20.0,  10.0},
		{1.6470152535015836,     20.0,  15.0},
		{3188.7503288536154,     20.0,  20.0},
		{2449840.5422952301,     20.0,  25.0},
		{1126985104.4483771,     20.0,  30.0},
		{379617876611.88580,     20.0,  35.0},
		{104459633129479.88,     20.0,  40.0},
		{25039579987216524.,     20.0,  45.0},
		{5.4420084027529984e+18, 20.0,  50.0},
		{1.1007498584335495e+21, 20.0,  55.0},
		{2.1091734863057236e+23, 20.0,  60.0},
		{3.8763618091286891e+25, 20.0,  65.0},
		{6.8946130527930870e+27, 20.0,  70.0},
		{1.1946319948836447e+30, 20.0,  75.0},
		{2.0265314377577587e+32, 20.0,  80.0},
		{3.3784665214179985e+34, 20.0,  85.0},
		{5.5516089411796646e+36, 20.0,  90.0},
		{9.0129310795305151e+38, 20.0,  95.0},
		{1.4483461256427176e+41, 20.0, 100.0},

		{0.0000000000000000,     50.0,   0.0},
		{2.9314696468108517e-45, 50.0,   5.0},
		{4.7568945607268435e-30, 50.0,  10.0},
		{5.5468372730667069e-21, 50.0,  15.0},
		{2.2551205757604056e-14, 50.0,  20.0},
		{4.5344251866130257e-09, 50.0,  25.0},
		{0.00014590106916468940, 50.0,  30.0},
		{1.3965549457254882,     50.0,  35.0},
		{5726.8656631289887,     50.0,  40.0},
		{12672593.113027781,     50.0,  45.0},
		{17650802430.016712,     50.0,  50.0},
		{17220231607789.926,     50.0,  55.0},
		{12704607933652176.,     50.0,  60.0},
		{7.4989491942193715e+18, 50.0,  65.0},
		{3.6944034898904922e+21, 50.0,  70.0},
		{1.5691634774370186e+24, 50.0,  75.0},
		{5.8927749458163587e+26, 50.0,  80.0},
		{1.9958849054749339e+29, 50.0,  85.0},
		{6.1946050361781500e+31, 50.0,  90.0},
		{1.7845429728697119e+34, 50.0,  95.0},
		{4.8219580855940819e+36, 50.0, 100.0},

		{0.0000000000000000,      100.0,   0.0},
		{7.0935514885313123e-119, 100.0,   5.0},
		{1.0823442017492015e-88,  100.0,  10.0},
		{5.9887888536468904e-71,  100.0,  15.0},
		{2.8703193216428771e-58,  100.0,  20.0},
		{2.4426896913122370e-48,  100.0,  25.0},
		{3.9476420053334271e-40,  100.0,  30.0},
		{4.2836596180818780e-33,  100.0,  35.0},
		{6.6249380222596129e-27,  100.0,  40.0},
		{2.3702587262788900e-21,  100.0,  45.0},
		{2.7278879470966917e-16,  100.0,  50.0},
		{1.2763258878228082e-11,  100.0,  55.0},
		{2.8832770906491972e-07,  100.0,  60.0},
		{0.0035805902717061223,   100.0,  65.0},
		{27.017219102595387,      100.0,  70.0},
		{134001.44891209516,      100.0,  75.0},
		{465194832.85060996,      100.0,  80.0},
		{1189280653119.4814,      100.0,  85.0},
		{2334119331258728.0,      100.0,  90.0},
		{3.6399223078502436e+18,  100.0,  95.0},
		{4.6415349416162005e+21,  100.0, 100.0},
	};

	for (auto const& data : testcases)
	{
		auto const r = hamon::cyl_bessel_i(data.nu, data.x);

		if (data.expected > max)
		{
			EXPECT_EQ(+inf, r);
		}
		else if (data.expected < lowest)
		{
			EXPECT_EQ(-inf, r);
		}
		else if (0 <= data.expected && data.expected < min)
		{
			EXPECT_GT(min, r);
		}
		else
		{
			double tole = hamon::abs(data.expected) * error;
			EXPECT_NEAR(data.expected, (double)r, tole);
		}
	}
}

GTEST_TEST(CMathTest, CylBesselITest)
{
//	CylBesselITestFloat<float,       float>      ();
	CylBesselITestFloat<float,       double>     ();
	CylBesselITestFloat<float,       long double>();
	CylBesselITestFloat<double,      float>      ();
	CylBesselITestFloat<double,      double>     ();
	CylBesselITestFloat<double,      long double>();
	CylBesselITestFloat<long double, float>      ();
	CylBesselITestFloat<long double, double>     ();
	CylBesselITestFloat<long double, long double>();

	HAMON_CXX11_CONSTEXPR auto nanf = hamon::numeric_limits<float>::quiet_NaN();
	HAMON_CXX14_CONSTEXPR_EXPECT_TRUE(hamon::isnan(hamon::cyl_bessel_if(nanf, nanf)));
	HAMON_CXX14_CONSTEXPR_EXPECT_TRUE(hamon::isnan(hamon::cyl_bessel_if(nanf, 0.0f)));
	HAMON_CXX14_CONSTEXPR_EXPECT_TRUE(hamon::isnan(hamon::cyl_bessel_if(0.0f, nanf)));

	HAMON_CXX11_CONSTEXPR auto nanl = hamon::numeric_limits<long double>::quiet_NaN();
	HAMON_CXX14_CONSTEXPR_EXPECT_TRUE(hamon::isnan(hamon::cyl_bessel_il(nanl, nanl)));
	HAMON_CXX14_CONSTEXPR_EXPECT_TRUE(hamon::isnan(hamon::cyl_bessel_il(nanl, 0.0l)));
	HAMON_CXX14_CONSTEXPR_EXPECT_TRUE(hamon::isnan(hamon::cyl_bessel_il(0.0l, nanl)));
}

}	// namespace cyl_bessel_i_test

}	// namespace hamon_cmath_test
