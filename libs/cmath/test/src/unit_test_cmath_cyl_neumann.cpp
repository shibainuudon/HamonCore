/**
 *	@file	unit_test_cmath_cyl_neumann.cpp
 *
 *	@brief	cyl_neumann のテスト
 */

#include <hamon/cmath/cyl_neumann.hpp>
#include <hamon/cmath/isnan.hpp>
#include <hamon/cmath/abs.hpp>
#include <hamon/type_traits/is_same.hpp>
#include <hamon/limits.hpp>
#include <gtest/gtest.h>
#include "constexpr_test.hpp"

namespace hamon_cmath_test
{

namespace cyl_neumann_test
{

static_assert(hamon::is_same<float,       decltype(hamon::cyl_neumann(0.0f, 0.0f))>::value, "");
static_assert(hamon::is_same<double,      decltype(hamon::cyl_neumann(0.0f, 0.0 ))>::value, "");
static_assert(hamon::is_same<long double, decltype(hamon::cyl_neumann(0.0f, 0.0l))>::value, "");
static_assert(hamon::is_same<double,      decltype(hamon::cyl_neumann(0.0f, 0   ))>::value, "");
static_assert(hamon::is_same<double,      decltype(hamon::cyl_neumann(0.0 , 0.0f))>::value, "");
static_assert(hamon::is_same<double,      decltype(hamon::cyl_neumann(0.0 , 0.0 ))>::value, "");
static_assert(hamon::is_same<long double, decltype(hamon::cyl_neumann(0.0 , 0.0l))>::value, "");
static_assert(hamon::is_same<double,      decltype(hamon::cyl_neumann(0.0 , 0   ))>::value, "");
static_assert(hamon::is_same<long double, decltype(hamon::cyl_neumann(0.0l, 0.0f))>::value, "");
static_assert(hamon::is_same<long double, decltype(hamon::cyl_neumann(0.0l, 0.0 ))>::value, "");
static_assert(hamon::is_same<long double, decltype(hamon::cyl_neumann(0.0l, 0.0l))>::value, "");
static_assert(hamon::is_same<long double, decltype(hamon::cyl_neumann(0.0l, 0   ))>::value, "");
static_assert(hamon::is_same<double,      decltype(hamon::cyl_neumann(0   , 0.0f))>::value, "");
static_assert(hamon::is_same<double,      decltype(hamon::cyl_neumann(0   , 0.0 ))>::value, "");
static_assert(hamon::is_same<long double, decltype(hamon::cyl_neumann(0   , 0.0l))>::value, "");
static_assert(hamon::is_same<double,      decltype(hamon::cyl_neumann(0   , 0   ))>::value, "");
static_assert(hamon::is_same<float,       decltype(hamon::cyl_neumannf(0.0f, 0.0f))>::value, "");
static_assert(hamon::is_same<long double, decltype(hamon::cyl_neumannl(0.0l, 0.0l))>::value, "");

template <typename T1, typename T2>
void CylNeumannTest(double error)
{
	using Promoted = hamon::float_promote_t<T1, T2>;
	HAMON_CXX11_CONSTEXPR auto nan1   = hamon::numeric_limits<T1>::quiet_NaN();
	HAMON_CXX11_CONSTEXPR auto nan2   = hamon::numeric_limits<T2>::quiet_NaN();
	HAMON_CXX11_CONSTEXPR auto inf    = hamon::numeric_limits<Promoted>::infinity();
	HAMON_CXX11_CONSTEXPR auto lowest = hamon::numeric_limits<Promoted>::lowest();
	HAMON_CXX11_CONSTEXPR auto max    = hamon::numeric_limits<Promoted>::max();
	HAMON_CXX11_CONSTEXPR auto min    = hamon::numeric_limits<Promoted>::min();

	HAMON_CXX14_CONSTEXPR_EXPECT_TRUE(hamon::isnan(hamon::cyl_neumann(nan1, nan2)));
	HAMON_CXX14_CONSTEXPR_EXPECT_TRUE(hamon::isnan(hamon::cyl_neumann(nan1, T2(0))));
	HAMON_CXX14_CONSTEXPR_EXPECT_TRUE(hamon::isnan(hamon::cyl_neumann(T1(0), nan2)));

	struct testcase
	{
		double expected;
		T1 nu;
		T2 x;
	};

	static testcase const testcases[] =
	{
		{-0.93157302493005878,  0.0, 0.25},
		{-0.44451873350670656,  0.0, 0.50},
		{-0.13717276938577236,  0.0, 0.75},
		{ 0.088256964215676942, 0.0, 1.00},
		{ 0.25821685159454072,  0.0, 1.25},
		{ 0.38244892379775886,  0.0, 1.50},
		{ 0.46549262864690610,  0.0, 1.75},
		{ 0.51037567264974493,  0.0, 2.00},
		{ 0.52006476245727862,  0.0, 2.25},
		{ 0.49807035961523194,  0.0, 2.50},
		{ 0.44865872156913222,  0.0, 2.75},
		{ 0.37685001001279045,  0.0, 3.00},
		{ 0.28828690267308710,  0.0, 3.25},
		{ 0.18902194392082688,  0.0, 3.50},
		{ 0.085256756977362638, 0.0, 3.75},
		{-0.016940739325064763, 0.0, 4.00},
		{-0.11191885116160770,  0.0, 4.25},
		{-0.19470500862950454,  0.0, 4.50},
		{-0.26123250323497549,  0.0, 4.75},
		{-0.30851762524903359,  0.0, 5.00},

		{-1.3461842332051073,   T1(1.0 / 3.0), 0.25},
		{-0.84062782604337771,  T1(1.0 / 3.0), 0.50},
		{-0.52488281484097088,  T1(1.0 / 3.0), 0.75},
		{-0.27880164127599216,  T1(1.0 / 3.0), 1.00},
		{-0.074321349727836453, T1(1.0 / 3.0), 1.25},
		{ 0.096610087766627981, T1(1.0 / 3.0), 1.50},
		{ 0.23582564494922068,  T1(1.0 / 3.0), 1.75},
		{ 0.34319996626034494,  T1(1.0 / 3.0), 2.00},
		{ 0.41835668452349323,  T1(1.0 / 3.0), 2.25},
		{ 0.46145947419129157,  T1(1.0 / 3.0), 2.50},
		{ 0.47358926135786023,  T1(1.0 / 3.0), 2.75},
		{ 0.45689303457230640,  T1(1.0 / 3.0), 3.00},
		{ 0.41458485697347386,  T1(1.0 / 3.0), 3.25},
		{ 0.35084133277859947,  T1(1.0 / 3.0), 3.50},
		{ 0.27061914527820891,  T1(1.0 / 3.0), 3.75},
		{ 0.17941676634394862,  T1(1.0 / 3.0), 4.00},
		{ 0.083000434191526043, T1(1.0 / 3.0), 4.25},
		{-0.012886361627105348, T1(1.0 / 3.0), 4.50},
		{-0.10281143123935124,  T1(1.0 / 3.0), 4.75},
		{-0.18192321129343850,  T1(1.0 / 3.0), 5.00},

		{-1.5461605241060765,   0.5, 0.25},
		{-0.99024588024340454,  0.5, 0.50},
		{-0.67411792914454438,  0.5, 0.75},
		{-0.43109886801837571,  0.5, 1.00},
		{-0.22502969244466481,  0.5, 1.25},
		{-0.046083165893097265, 0.5, 1.50},
		{ 0.10750804524368722,  0.5, 1.75},
		{ 0.23478571040624849,  0.5, 2.00},
		{ 0.33414002338271825,  0.5, 2.25},
		{ 0.40427830223905686,  0.5, 2.50},
		{ 0.44472115119490507,  0.5, 2.75},
		{ 0.45604882079463316,  0.5, 3.00},
		{ 0.43998859501924370,  0.5, 3.25},
		{ 0.39938682536304909,  0.5, 3.50},
		{ 0.33809163836693340,  0.5, 3.75},
		{ 0.26076607667717877,  0.5, 4.00},
		{ 0.17264962544644955,  0.5, 4.25},
		{ 0.079285862862978548, 0.5, 4.50},
		{-0.013765943019498003, 0.5, 4.75},
		{-0.10121770918510846,  0.5, 5.00},

		{-1.8021638417426857,   T1(2.0 / 3.0), 0.25},
		{-1.1316060101031435,   T1(2.0 / 3.0), 0.50},
		{-0.80251156358450748,  T1(2.0 / 3.0), 0.75},
		{-0.56270321497463327,  T1(2.0 / 3.0), 1.00},
		{-0.36007453643432208,  T1(2.0 / 3.0), 1.25},
		{-0.18017937469615020,  T1(2.0 / 3.0), 1.50},
		{-0.019885608758103752, T1(2.0 / 3.0), 1.75},
		{ 0.11989345361903521,  T1(2.0 / 3.0), 2.00},
		{ 0.23690889836358039,  T1(2.0 / 3.0), 2.25},
		{ 0.32882045742954535,  T1(2.0 / 3.0), 2.50},
		{ 0.39385133784531856,  T1(2.0 / 3.0), 2.75},
		{ 0.43115101690935642,  T1(2.0 / 3.0), 3.00},
		{ 0.44098127351445843,  T1(2.0 / 3.0), 3.25},
		{ 0.42477631413456485,  T1(2.0 / 3.0), 3.50},
		{ 0.38510384155620386,  T1(2.0 / 3.0), 3.75},
		{ 0.32554526794354366,  T1(2.0 / 3.0), 4.00},
		{ 0.25051080073878446,  T1(2.0 / 3.0), 4.25},
		{ 0.16500507211842136,  T1(2.0 / 3.0), 4.50},
		{ 0.074359649728861360, T1(2.0 / 3.0), 4.75},
		{-0.016050662643389627, T1(2.0 / 3.0), 5.00},

		{-2.7041052293152825,   1.0, 0.25},
		{-1.4714723926702433,   1.0, 0.50},
		{-1.0375945507692856,   1.0, 0.75},
		{-0.78121282130028891,  1.0, 1.00},
		{-0.58436403661500824,  1.0, 1.25},
		{-0.41230862697391119,  1.0, 1.50},
		{-0.25397298594624573,  1.0, 1.75},
		{-0.10703243154093699,  1.0, 2.00},
		{ 0.027192057738017056, 1.0, 2.25},
		{ 0.14591813796678599,  1.0, 2.50},
		{ 0.24601900149738354,  1.0, 2.75},
		{ 0.32467442479180003,  1.0, 3.00},
		{ 0.37977777371708382,  1.0, 3.25},
		{ 0.41018841788751170,  1.0, 3.50},
		{ 0.41586877934522715,  1.0, 3.75},
		{ 0.39792571055709991,  1.0, 4.00},
		{ 0.35856889308385076,  1.0, 4.25},
		{ 0.30099732306965449,  1.0, 4.50},
		{ 0.22922559673872217,  1.0, 4.75},
		{ 0.14786314339122700,  1.0, 5.00},

		{-20.701268809592200,   2.0, 0.25},
		{-5.4413708371742668,   2.0, 0.50},
		{-2.6297460326656559,   2.0, 0.75},
		{-1.6506826068162548,   2.0, 1.00},
		{-1.1931993101785539,   2.0, 1.25},
		{-0.93219375976297369,  2.0, 1.50},
		{-0.75574746972832973,  2.0, 1.75},
		{-0.61740810419068193,  2.0, 2.00},
		{-0.49589404446793012,  2.0, 2.25},
		{-0.38133584924180314,  2.0, 2.50},
		{-0.26973581138921693,  2.0, 2.75},
		{-0.16040039348492377,  2.0, 3.00},
		{-0.054577503462573951, 2.0, 3.25},
		{ 0.045371437729179787, 2.0, 3.50},
		{ 0.13653992534009185,  2.0, 3.75},
		{ 0.21590359460361472,  2.0, 4.00},
		{ 0.28065715378930217,  2.0, 4.25},
		{ 0.32848159666046206,  2.0, 4.50},
		{ 0.35774854396706901,  2.0, 4.75},
		{ 0.36766288260552438,  2.0, 5.00},

		{-251309.48151852371,  5.0, 0.25},
		{-7946.3014788074752,  5.0, 0.50},
		{-1067.2468952289760,  5.0, 0.75},
		{-260.40586662581228,  5.0, 1.00},
		{-88.474252441880395,  5.0, 1.25},
		{-37.190308395498064,  5.0, 1.50},
		{-18.165774988201832,  5.0, 1.75},
		{-9.9359891284819675,  5.0, 2.00},
		{-5.9446343848076424,  5.0, 2.25},
		{-3.8301760007407522,  5.0, 2.50},
		{-2.6287042009459087,  5.0, 2.75},
		{-1.9059459538286738,  5.0, 3.00},
		{-1.4498157389142654,  5.0, 3.25},
		{-1.1494603169763686,  5.0, 3.50},
		{-0.94343105151431672, 5.0, 3.75},
		{-0.79585142111419982, 5.0, 4.00},
		{-0.68479288173907016, 5.0, 4.25},
		{-0.59631936513587558, 5.0, 4.50},
		{-0.52130838331747587, 5.0, 4.75},
		{-0.45369482249110193, 5.0, 5.00},

		{-124241617095379.48, 10.0, 0.25},
		{-121963623349.56966, 10.0, 0.50},
		{-2133501638.9057348, 10.0, 0.75},
		{-121618014.27868921, 10.0, 1.00},
		{-13265210.158452792, 10.0, 1.25},
		{-2183993.0260864049, 10.0, 1.50},
		{-478274.82386541169, 10.0, 1.75},
		{-129184.54220803917, 10.0, 2.00},
		{-40993.254794381690, 10.0, 2.25},
		{-14782.847716021070, 10.0, 2.50},
		{-5916.5330998776262, 10.0, 2.75},
		{-2582.6071294842995, 10.0, 3.00},
		{-1213.3423564023892, 10.0, 3.25},
		{-607.27437834125760, 10.0, 3.50},
		{-321.17461059752202, 10.0, 3.75},
		{-178.33055590796428, 10.0, 4.00},
		{-103.40496587570090, 10.0, 4.25},
		{-62.345024619781434, 10.0, 4.50},
		{-38.944510430296937, 10.0, 4.75},
		{-25.129110095610095, 10.0, 5.00},

		{-4.4678815064152581e+34, 20.0, 0.25},
		{-4.2714301215659088e+28, 20.0, 0.50},
		{-1.2898357375834223e+25, 20.0, 0.75},
		{-4.1139703148355065e+22, 20.0, 1.00},
		{-4.7783533372148580e+20, 20.0, 1.25},
		{-1.2577301772964241e+19, 20.0, 1.50},
		{-5.8251041176649626e+17, 20.0, 1.75},
		{-40816513889983640.,     20.0, 2.00},
		{-3925339868516418.5,     20.0, 2.25},
		{-484776559582090.25,     20.0, 2.50},
		{-73320655044814.469,     20.0, 2.75},
		{-13113540041757.449,     20.0, 3.00},
		{-2700669268882.7139,     20.0, 3.25},
		{-627339518240.21240,     20.0, 3.50},
		{-161695236802.71753,     20.0, 3.75},
		{-45637199262.220100,     20.0, 4.00},
		{-13953299213.925377,     20.0, 4.25},
		{-4580215756.5691023,     20.0, 4.50},
		{-1602110715.5159132,     20.0, 4.75},
		{-593396529.69143200,     20.0, 5.00},

		{-2.7643487471155969e+107, 50.0, 0.25},
		{-2.4575848224461092e+92,  50.0, 0.50},
		{-3.8604508467683829e+83,  50.0, 0.75},
		{-2.1911428126053411e+77,  50.0, 1.00},
		{-3.1362926828833165e+72,  50.0, 1.25},
		{-3.4584216846550566e+68,  50.0, 1.50},
		{-1.5607714080312795e+65,  50.0, 1.75},
		{-1.9761505765184128e+62,  50.0, 2.00},
		{-5.5023640499231188e+59,  50.0, 2.25},
		{-2.8530384545826849e+57,  50.0, 2.50},
		{-2.4467169322684809e+55,  50.0, 2.75},
		{-3.1793891461005181e+53,  50.0, 3.00},
		{-5.8573901231568658e+51,  50.0, 3.25},
		{-1.4528262197760965e+50,  50.0, 3.50},
		{-4.6566569870478635e+48,  50.0, 3.75},
		{-1.8661134361400254e+47,  50.0, 4.00},
		{-9.1005883612255402e+45,  50.0, 4.25},
		{-5.2813777542386141e+44,  50.0, 4.50},
		{-3.5795477722116469e+43,  50.0, 4.75},
		{-2.7888370175838930e+42,  50.0, 5.00},

		{-6.0523080585856763e+245, 100.0, 0.25},
		{-4.7766903780412668e+215, 100.0, 0.50},
		{-1.1758283017660654e+198, 100.0, 0.75},
		{-3.7752878101091316e+185, 100.0, 1.00},
		{-7.7013290729995187e+175, 100.0, 1.25},
		{-9.3152624794288802e+167, 100.0, 1.50},
		{-1.8854163374247264e+161, 100.0, 1.75},
		{-3.0008260488566283e+155, 100.0, 2.00},
		{-2.3075650873777408e+150, 100.0, 2.25},
		{-6.1476258561369381e+145, 100.0, 2.50},
		{-4.4758816234829593e+141, 100.0, 2.75},
		{-7.4747961023547862e+137, 100.0, 3.00},
		{-2.5067022766901547e+134, 100.0, 3.25},
		{-1.5222488313432757e+131, 100.0, 3.50},
		{-1.5422392812241399e+128, 100.0, 3.75},
		{-2.4400857387551062e+125, 100.0, 4.00},
		{-5.7118153392422293e+122, 100.0, 4.25},
		{-1.8915420905193392e+120, 100.0, 4.50},
		{-8.5357945104770158e+117, 100.0, 4.75},
		{-5.0848639160196196e+115, 100.0, 5.00},

		{-0.30851762524903359,   0.0,   5.0},
		{ 0.055671167283599457,  0.0,  10.0},
		{ 0.20546429603891822,   0.0,  15.0},
		{ 0.062640596809384053,  0.0,  20.0},
		{-0.12724943226800617,   0.0,  25.0},
		{-0.11729573168666413,   0.0,  30.0},
		{ 0.045797987195155689,  0.0,  35.0},
		{ 0.12593641705826092,   0.0,  40.0},
		{ 0.027060469763313333,  0.0,  45.0},
		{-0.098064995470077118,  0.0,  50.0},
		{-0.077569178730412594,  0.0,  55.0},
		{ 0.047358952209449426,  0.0,  60.0},
		{ 0.097183557740181920,  0.0,  65.0},
		{ 0.0093096664589409992, 0.0,  70.0},
		{-0.085369047647775656,  0.0,  75.0},
		{-0.055620339089770016,  0.0,  80.0},
		{ 0.049567884951494251,  0.0,  85.0},
		{ 0.079776475854877751,  0.0,  90.0},
		{-0.0028230995861232107, 0.0,  95.0},
		{-0.077244313365083153,  0.0, 100.0},

		{-0.18192321129343850,  T1(1.0 / 3.0),   5.0},
		{ 0.17020111788268760,  T1(1.0 / 3.0),  10.0},
		{ 0.18540507541540796,  T1(1.0 / 3.0),  15.0},
		{-0.028777707635715043, T1(1.0 / 3.0),  20.0},
		{-0.15829741864944163,  T1(1.0 / 3.0),  25.0},
		{-0.058645772316705209, T1(1.0 / 3.0),  30.0},
		{ 0.10294930308870617,  T1(1.0 / 3.0),  35.0},
		{ 0.10547870367098922,  T1(1.0 / 3.0),  40.0},
		{-0.034334228816010816, T1(1.0 / 3.0),  45.0},
		{-0.11283489933031279,  T1(1.0 / 3.0),  50.0},
		{-0.030007358986895105, T1(1.0 / 3.0),  55.0},
		{ 0.086699173295718121, T1(1.0 / 3.0),  60.0},
		{ 0.074875579668878658, T1(1.0 / 3.0),  65.0},
		{-0.039323246374552680, T1(1.0 / 3.0),  70.0},
		{-0.091263539574475236, T1(1.0 / 3.0),  75.0},
		{-0.013358849535984318, T1(1.0 / 3.0),  80.0},
		{ 0.078373575537830198, T1(1.0 / 3.0),  85.0},
		{ 0.055812482883955940, T1(1.0 / 3.0),  90.0},
		{-0.043310380106990683, T1(1.0 / 3.0),  95.0},
		{-0.076900504962136559, T1(1.0 / 3.0), 100.0},

		{-0.10121770918510846,   0.5,   5.0},
		{ 0.21170886633139810,   0.5,  10.0},
		{ 0.15650551590730855,   0.5,  15.0},
		{-0.072806904785061938,  0.5,  20.0},
		{-0.15817308404205055,   0.5,  25.0},
		{-0.022470290598831138,  0.5,  30.0},
		{ 0.12187835265849535,   0.5,  35.0},
		{ 0.084138655676395377,  0.5,  40.0},
		{-0.062482641933003201,  0.5,  45.0},
		{-0.10888475635053954,   0.5,  50.0},
		{-0.0023805454010949376, 0.5,  55.0},
		{ 0.098104683735037918,  0.5,  60.0},
		{ 0.055663470218594434,  0.5,  65.0},
		{-0.060396767883824871,  0.5,  70.0},
		{-0.084922578922046868,  0.5,  75.0},
		{ 0.0098472271924441284, 0.5,  80.0},
		{ 0.085190643574343625,  0.5,  85.0},
		{ 0.037684970437156268,  0.5,  90.0},
		{-0.059772904856097500,  0.5,  95.0},
		{-0.068803091468728109,  0.5, 100.0},

		{-0.016050662643389627, T1(2.0 / 3.0),   5.0},
		{ 0.23937232657540733,  T1(2.0 / 3.0),  10.0},
		{ 0.11762106604241235,  T1(2.0 / 3.0),  15.0},
		{-0.11182254014899558,  T1(2.0 / 3.0),  20.0},
		{-0.14756582982938804,  T1(2.0 / 3.0),  25.0},
		{ 0.015078692908077713, T1(2.0 / 3.0),  30.0},
		{ 0.13260911815705795,  T1(2.0 / 3.0),  35.0},
		{ 0.057217565989652698, T1(2.0 / 3.0),  40.0},
		{-0.086373755152382006, T1(2.0 / 3.0),  45.0},
		{-0.097624139208051616, T1(2.0 / 3.0),  50.0},
		{ 0.025354902147023392, T1(2.0 / 3.0),  55.0},
		{ 0.10288136476351206,  T1(2.0 / 3.0),  60.0},
		{ 0.032728379560128203, T1(2.0 / 3.0),  65.0},
		{-0.077363672735747818, T1(2.0 / 3.0),  70.0},
		{-0.072855870458293961, T1(2.0 / 3.0),  75.0},
		{ 0.032358106046953543, T1(2.0 / 3.0),  80.0},
		{ 0.086240651537394228, T1(2.0 / 3.0),  85.0},
		{ 0.017029601697285190, T1(2.0 / 3.0),  90.0},
		{-0.072173520560584681, T1(2.0 / 3.0),  95.0},
		{-0.056057339204073887, T1(2.0 / 3.0), 100.0},

		{ 0.14786314339122700,   1.0,   5.0},
		{ 0.24901542420695386,   1.0,  10.0},
		{ 0.021073628036873522,  1.0,  15.0},
		{-0.16551161436252115,   1.0,  20.0},
		{-0.098829964783237412,  1.0,  25.0},
		{ 0.084425570661747135,  1.0,  30.0},
		{ 0.12751273354559009,   1.0,  35.0},
		{-0.0057935058215497536, 1.0,  40.0},
		{-0.11552517964639945,   1.0,  45.0},
		{-0.056795668562014692,  1.0,  50.0},
		{ 0.073846265432577926,  1.0,  55.0},
		{ 0.091869609369866892,  1.0,  60.0},
		{-0.017940374275377362,  1.0,  65.0},
		{-0.094844652625716230,  1.0,  70.0},
		{-0.035213785160580421,  1.0,  75.0},
		{ 0.069395913784588037,  1.0,  80.0},
		{ 0.071233187582749768,  1.0,  85.0},
		{-0.026187238607768244,  1.0,  90.0},
		{-0.081827958724501215,  1.0,  95.0},
		{-0.020372312002759834,  1.0, 100.0},

		{ 0.36766288260552438,   2.0,   5.0},
		{-0.0058680824422086830, 2.0,  10.0},
		{-0.20265447896733507,   2.0,  15.0},
		{-0.079191758245636165,  2.0,  20.0},
		{ 0.11934303508534717,   2.0,  25.0},
		{ 0.12292410306411394,   2.0,  30.0},
		{-0.038511545278264829,  2.0,  35.0},
		{-0.12622609234933840,   2.0,  40.0},
		{-0.032194922192042195,  2.0,  45.0},
		{ 0.095793168727596537,  2.0,  50.0},
		{ 0.080254497473415426,  2.0,  55.0},
		{-0.044296631897120527,  2.0,  60.0},
		{-0.097735569256347382,  2.0,  65.0},
		{-0.012019513676818605,  2.0,  70.0},
		{ 0.084430013376826846,  2.0,  75.0},
		{ 0.057355236934384719,  2.0,  80.0},
		{-0.047891809949547198,  2.0,  85.0},
		{-0.080358414490605934,  2.0,  90.0},
		{ 0.0011004057182389746, 2.0,  95.0},
		{ 0.076836867125027963,  2.0, 100.0},

		{-0.45369482249110193,    5.0,   5.0},
		{ 0.13540304768936234,    5.0,  10.0},
		{ 0.16717271575940015,    5.0,  15.0},
		{-0.10003576788953220,    5.0,  20.0},
		{-0.14705799311372267,    5.0,  25.0},
		{ 0.031627359289264301,   5.0,  30.0},
		{ 0.13554781474770028,    5.0,  35.0},
		{ 0.031869448780850247,   5.0,  40.0},
		{-0.10426932700176872,    5.0,  45.0},
		{-0.078548413913081594,   5.0,  50.0},
		{ 0.055257033062858375,   5.0,  55.0},
		{ 0.099464632840450887,   5.0,  60.0},
		{ 0.00023860469499595305, 5.0,  65.0},
		{-0.091861802216406052,   5.0,  70.0},
		{-0.048383671296970042,   5.0,  75.0},
		{ 0.060293667104896316,   5.0,  80.0},
		{ 0.077506166682733996,   5.0,  85.0},
		{-0.015338764062239767,   5.0,  90.0},
		{-0.081531504045514361,   5.0,  95.0},
		{-0.029480196281661937,   5.0, 100.0},

		{-25.129110095610095,    10.0,   5.0},
		{-0.35981415218340279,   10.0,  10.0},
		{ 0.21997141360195577,   10.0,  15.0},
		{-0.043894653515658105,  10.0,  20.0},
		{-0.14871839049980651,   10.0,  25.0},
		{ 0.075056702122397012,  10.0,  30.0},
		{ 0.12222473135000546,   10.0,  35.0},
		{-0.046723877232677985,  10.0,  40.0},
		{-0.11739339009322181,   10.0,  45.0},
		{ 0.0057238971820535930, 10.0,  50.0},
		{ 0.10733910125831631,   10.0,  55.0},
		{ 0.036290350559545478,  10.0,  60.0},
		{-0.083239127691715667,  10.0,  65.0},
		{-0.069639384138314858,  10.0,  70.0},
		{ 0.045798335061325066,  10.0,  75.0},
		{ 0.086269195064844456,  10.0,  80.0},
		{-0.0018234674126248740, 10.0,  85.0},
		{-0.082067762371231284,  10.0,  90.0},
		{-0.038798074754578089,  10.0,  95.0},
		{ 0.058331574236414913,  10.0, 100.0},

		{-593396529.69143200,    20.0,   5.0},
		{-1597.4838482696259,    20.0,  10.0},
		{-3.3087330924737621,    20.0,  15.0},
		{-0.28548945860020319,   20.0,  20.0},
		{ 0.19804074776289243,   20.0,  25.0},
		{-0.16848153948742683,   20.0,  30.0},
		{ 0.10102784152594022,   20.0,  35.0},
		{ 0.045161820565805755,  20.0,  40.0},
		{-0.12556489308015448,   20.0,  45.0},
		{ 0.016442633948115834,  20.0,  50.0},
		{ 0.10853448778255181,   20.0,  55.0},
		{-0.026721408520664701,  20.0,  60.0},
		{-0.098780425256324175,  20.0,  65.0},
		{ 0.016201957786018233,  20.0,  70.0},
		{ 0.093591198265063721,  20.0,  75.0},
		{ 0.0040484400737296200, 20.0,  80.0},
		{-0.086314929459920531,  20.0,  85.0},
		{-0.028274110097231530,  20.0,  90.0},
		{ 0.072349520791638741,  20.0,  95.0},
		{ 0.051247973076188474,  20.0, 100.0},

		{-2.7888370175838930e+42, 50.0,   5.0},
		{-3.6410665018007421e+27, 50.0,  10.0},
		{-1.0929732912175415e+19, 50.0,  15.0},
		{-15606426801663.734,     50.0,  20.0},
		{-753573251.44662738,     50.0,  25.0},
		{-386759.32602734759,     50.0,  30.0},
		{-1172.8690492895323,     50.0,  35.0},
		{-15.615608873419944,     50.0,  40.0},
		{-0.87058346204176895,    50.0,  45.0},
		{-0.21031655464397747,    50.0,  50.0},
		{ 0.093048240412999389,   50.0,  55.0},
		{ 0.0086417699626744754,  50.0,  60.0},
		{-0.025019788459222037,   50.0,  65.0},
		{-0.0014815155191909152,  50.0,  70.0},
		{ 0.050335774732164121,   50.0,  75.0},
		{-0.092924250967987232,   50.0,  80.0},
		{ 0.087332463030205698,   50.0,  85.0},
		{-0.016164237701651860,   50.0,  90.0},
		{-0.068897613820457934,   50.0,  95.0},
		{ 0.076505263944803045,   50.0, 100.0},

		{-5.0848639160196196e+115, 100.0,   5.0},
		{-4.8491482711800252e+85,  100.0,  10.0},
		{-1.6375955323195320e+68,  100.0,  15.0},
		{-8.2002648144679115e+55,  100.0,  20.0},
		{-2.9712216432562368e+46,  100.0,  25.0},
		{-7.2875284708240751e+38,  100.0,  30.0},
		{-3.4251079902107980e+32,  100.0,  35.0},
		{-1.4552439438102214e+27,  100.0,  40.0},
		{-3.4506612476220073e+22,  100.0,  45.0},
		{-3.2938001882025477e+18,  100.0,  50.0},
		{-1005686182055520.4,      100.0,  55.0},
		{-831892881402.09033,      100.0,  60.0},
		{-1650863778.0598392,      100.0,  65.0},
		{-7192614.1976097794,      100.0,  70.0},
		{-64639.072261231595,      100.0,  75.0},
		{-1152.5905185698466,      100.0,  80.0},
		{-40.250761402101489,      100.0,  85.0},
		{-2.8307771387185294,      100.0,  90.0},
		{-0.45762200495904848,     100.0,  95.0},
		{-0.16692141141757652,     100.0, 100.0},

		{-2.2438688257729954e-02, 100.0, 1000.0},
		{-2.1077595159819992e-02, 100.0, 1100.0},
		{-3.5299439206692585e-03, 100.0, 1200.0},
		{ 1.4250019326536615e-02, 100.0, 1300.0},
		{ 2.1304679089735663e-02, 100.0, 1400.0},
		{ 1.5734395077905267e-02, 100.0, 1500.0},
		{ 2.5544633636137774e-03, 100.0, 1600.0},
		{-1.0722045524849367e-02, 100.0, 1700.0},
		{-1.8036919243226864e-02, 100.0, 1800.0},
		{-1.6958415593079763e-02, 100.0, 1900.0},
		{-8.8788704566276667e-03, 100.0, 2000.0},
		{ 2.2504407108413179e-03, 100.0, 2100.0},
		{ 1.1833215246712251e-02, 100.0, 2200.0},
		{ 1.6398784536343945e-02, 100.0, 2300.0},
		{ 1.4675984403642338e-02, 100.0, 2400.0},
		{ 7.7523920451654229e-03, 100.0, 2500.0},
		{-1.5759822576003489e-03, 100.0, 2600.0},
		{-9.9314877404787089e-03, 100.0, 2700.0},
		{-1.4534495161704743e-02, 100.0, 2800.0},
		{-1.4059273497237509e-02, 100.0, 2900.0},
		{-8.9385158149605185e-03, 100.0, 3000.0},
	};

	for (auto const& data : testcases)
	{
		auto const r = hamon::cyl_neumann(data.nu, data.x);

		if (data.expected > max)
		{
			if (!hamon::isnan(r))
			{
				EXPECT_EQ(+inf, r);
			}
		}
		else if (data.expected < lowest)
		{
			if (!hamon::isnan(r))
			{
				EXPECT_EQ(-inf, r);
			}
		}
		else if (0 <= data.expected && data.expected < min)
		{
			EXPECT_GT(min, r);
		}
		else
		{
			double tole = hamon::abs(data.expected) * error;
			EXPECT_NEAR(data.expected, (double)r, tole);
		}
	}
}

GTEST_TEST(CMathTest, CylNeumannTest)
{
	CylNeumannTest<float,       float>      (0.01);
	CylNeumannTest<float,       double>     (0.000001);
	CylNeumannTest<float,       long double>(0.000001);
	CylNeumannTest<double,      float>      (0.0000000001);
	CylNeumannTest<double,      double>     (0.0000000001);
	CylNeumannTest<double,      long double>(0.0000000001);
	CylNeumannTest<long double, float>      (0.0000000001);
	CylNeumannTest<long double, double>     (0.0000000001);
	CylNeumannTest<long double, long double>(0.0000000001);

	HAMON_CXX11_CONSTEXPR auto nanf = hamon::numeric_limits<float>::quiet_NaN();
	HAMON_CXX14_CONSTEXPR_EXPECT_TRUE(hamon::isnan(hamon::cyl_neumannf(nanf, nanf)));
	HAMON_CXX14_CONSTEXPR_EXPECT_TRUE(hamon::isnan(hamon::cyl_neumannf(nanf, 0.0f)));
	HAMON_CXX14_CONSTEXPR_EXPECT_TRUE(hamon::isnan(hamon::cyl_neumannf(0.0f, nanf)));

	HAMON_CXX11_CONSTEXPR auto nanl = hamon::numeric_limits<long double>::quiet_NaN();
	HAMON_CXX14_CONSTEXPR_EXPECT_TRUE(hamon::isnan(hamon::cyl_neumannl(nanl, nanl)));
	HAMON_CXX14_CONSTEXPR_EXPECT_TRUE(hamon::isnan(hamon::cyl_neumannl(nanl, 0.0l)));
	HAMON_CXX14_CONSTEXPR_EXPECT_TRUE(hamon::isnan(hamon::cyl_neumannl(0.0l, nanl)));
}

}	// namespace cyl_neumann_test

}	// namespace hamon_cmath_test
