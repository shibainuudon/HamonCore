/**
 *	@file	unit_test_cmath_cyl_bessel_k.cpp
 *
 *	@brief	cyl_bessel_k のテスト
 */

#include <hamon/cmath/cyl_bessel_k.hpp>
#include <hamon/cmath/isnan.hpp>
#include <hamon/cmath/abs.hpp>
#include <hamon/type_traits/is_same.hpp>
#include <hamon/limits.hpp>
#include <gtest/gtest.h>
#include "constexpr_test.hpp"

namespace hamon_cmath_test
{

namespace cyl_bessel_k_test
{

static_assert(hamon::is_same<float,       decltype(hamon::cyl_bessel_k(0.0f, 0.0f))>::value, "");
static_assert(hamon::is_same<double,      decltype(hamon::cyl_bessel_k(0.0f, 0.0 ))>::value, "");
static_assert(hamon::is_same<long double, decltype(hamon::cyl_bessel_k(0.0f, 0.0l))>::value, "");
static_assert(hamon::is_same<double,      decltype(hamon::cyl_bessel_k(0.0f, 0   ))>::value, "");
static_assert(hamon::is_same<double,      decltype(hamon::cyl_bessel_k(0.0 , 0.0f))>::value, "");
static_assert(hamon::is_same<double,      decltype(hamon::cyl_bessel_k(0.0 , 0.0 ))>::value, "");
static_assert(hamon::is_same<long double, decltype(hamon::cyl_bessel_k(0.0 , 0.0l))>::value, "");
static_assert(hamon::is_same<double,      decltype(hamon::cyl_bessel_k(0.0 , 0   ))>::value, "");
static_assert(hamon::is_same<long double, decltype(hamon::cyl_bessel_k(0.0l, 0.0f))>::value, "");
static_assert(hamon::is_same<long double, decltype(hamon::cyl_bessel_k(0.0l, 0.0 ))>::value, "");
static_assert(hamon::is_same<long double, decltype(hamon::cyl_bessel_k(0.0l, 0.0l))>::value, "");
static_assert(hamon::is_same<long double, decltype(hamon::cyl_bessel_k(0.0l, 0   ))>::value, "");
static_assert(hamon::is_same<double,      decltype(hamon::cyl_bessel_k(0   , 0.0f))>::value, "");
static_assert(hamon::is_same<double,      decltype(hamon::cyl_bessel_k(0   , 0.0 ))>::value, "");
static_assert(hamon::is_same<long double, decltype(hamon::cyl_bessel_k(0   , 0.0l))>::value, "");
static_assert(hamon::is_same<double,      decltype(hamon::cyl_bessel_k(0   , 0   ))>::value, "");
static_assert(hamon::is_same<float,       decltype(hamon::cyl_bessel_kf(0.0f, 0.0f))>::value, "");
static_assert(hamon::is_same<long double, decltype(hamon::cyl_bessel_kl(0.0l, 0.0l))>::value, "");

template <typename T1, typename T2>
struct get_error
{
	static HAMON_CXX11_CONSTEXPR double get()
	{
		return 0.0000000001;
	}
};

template <typename T2>
struct get_error<float, T2>
{
	static HAMON_CXX11_CONSTEXPR double get()
	{
		return 0.00001;
	}
};

template <typename T1, typename T2>
void CylBesselKTest()
{
	using Promoted = hamon::float_promote_t<T1, T2>;
	HAMON_CXX11_CONSTEXPR auto nan1   = hamon::numeric_limits<T1>::quiet_NaN();
	HAMON_CXX11_CONSTEXPR auto nan2   = hamon::numeric_limits<T2>::quiet_NaN();
	HAMON_CXX11_CONSTEXPR auto inf    = hamon::numeric_limits<Promoted>::infinity();
	HAMON_CXX11_CONSTEXPR auto lowest = hamon::numeric_limits<Promoted>::lowest();
	HAMON_CXX11_CONSTEXPR auto max    = hamon::numeric_limits<Promoted>::max();
	HAMON_CXX11_CONSTEXPR auto min    = hamon::numeric_limits<Promoted>::min();

	HAMON_CXX11_CONSTEXPR double error = get_error<T1, T2>::get();

	HAMON_CXX14_CONSTEXPR_EXPECT_TRUE(hamon::isnan(hamon::cyl_bessel_k(nan1, nan2)));
	HAMON_CXX14_CONSTEXPR_EXPECT_TRUE(hamon::isnan(hamon::cyl_bessel_k(nan1, T2(0))));
	HAMON_CXX14_CONSTEXPR_EXPECT_TRUE(hamon::isnan(hamon::cyl_bessel_k(T1(0), nan2)));

	HAMON_CXX14_CONSTEXPR_EXPECT_NEAR(1.5415067512483025,  (double)hamon::cyl_bessel_k(T1(0.0), T2(0.25)), error);
	HAMON_CXX14_CONSTEXPR_EXPECT_NEAR(0.21380556264752565, (double)hamon::cyl_bessel_k(T1(0.0), T2(1.50)), error);
//	HAMON_CXX14_CONSTEXPR_EXPECT_NEAR(0.11389387274953360, (double)hamon::cyl_bessel_k(T1(0.0), T2(2.00)), error);	// TODO
	HAMON_CXX14_CONSTEXPR_EXPECT_NEAR(1.0750476034999195,  (double)hamon::cyl_bessel_k(T1(0.5), T2(0.50)), error);
//	HAMON_CXX14_CONSTEXPR_EXPECT_NEAR(0.065065943154009986,(double)hamon::cyl_bessel_k(T1(0.5), T2(2.50)), error);	// TODO
	HAMON_CXX14_CONSTEXPR_EXPECT_NEAR(1.6564411200033007,  (double)hamon::cyl_bessel_k(T1(1.0), T2(0.50)), error);
//	HAMON_CXX14_CONSTEXPR_EXPECT_NEAR(0.040156431128194198,(double)hamon::cyl_bessel_k(T1(1.0), T2(3.00)), error);	// TODO
	HAMON_CXX14_CONSTEXPR_EXPECT_NEAR(3.1427970006821715,  (double)hamon::cyl_bessel_k(T1(2.0), T2(0.75)), error);
//	HAMON_CXX14_CONSTEXPR_EXPECT_NEAR(0.023647953146296131,(double)hamon::cyl_bessel_k(T1(2.0), T2(3.75)), error);	// TODO
	HAMON_CXX14_CONSTEXPR_EXPECT_NEAR(44.067781159301056,  (double)hamon::cyl_bessel_k(T1(5.0), T2(1.50)), error);

	struct testcase
	{
		double expected;
		T1 nu;
		T2 x;
	};

	static testcase const testcases[] =
	{
		{1.5415067512483025,      T1(  0.00000000000000000), T2(0.25)},
		{0.92441907122766565,     T1(  0.00000000000000000), T2(0.50)},
		{0.61058242211646430,     T1(  0.00000000000000000), T2(0.75)},
		{0.42102443824070834,     T1(  0.00000000000000000), T2(1.00)},
		{0.29760308908410588,     T1(  0.00000000000000000), T2(1.25)},
		{0.21380556264752565,     T1(  0.00000000000000000), T2(1.50)},
		{0.15537981238660359,     T1(  0.00000000000000000), T2(1.75)},
		{0.11389387274953360,     T1(  0.00000000000000000), T2(2.00)},
		{0.084043111974658191,    T1(  0.00000000000000000), T2(2.25)},
		{0.062347553200366168,    T1(  0.00000000000000000), T2(2.50)},
		{0.046454901308760774,    T1(  0.00000000000000000), T2(2.75)},
		{0.034739504386279256,    T1(  0.00000000000000000), T2(3.00)},
		{0.026058755255154966,    T1(  0.00000000000000000), T2(3.25)},
		{0.019598897170368501,    T1(  0.00000000000000000), T2(3.50)},
		{0.014774250877128707,    T1(  0.00000000000000000), T2(3.75)},
		{0.011159676085853030,    T1(  0.00000000000000000), T2(4.00)},
		{0.0084443877245429649,   T1(  0.00000000000000000), T2(4.25)},
		{0.0063998572432339756,   T1(  0.00000000000000000), T2(4.50)},
		{0.0048572045578879524,   T1(  0.00000000000000000), T2(4.75)},
		{0.0036910983340425947,   T1(  0.00000000000000000), T2(5.00)},

		{1.7144912564234513,      T1(  0.33333333333333333), T2(0.25)},
		{0.98903107424672421,     T1(  0.33333333333333333), T2(0.50)},
		{0.64216899667282989,     T1(  0.33333333333333333), T2(0.75)},
		{0.43843063344153443,     T1(  0.33333333333333333), T2(1.00)},
		{0.30788192414945043,     T1(  0.33333333333333333), T2(1.25)},
		{0.22015769026776688,     T1(  0.33333333333333333), T2(1.50)},
		{0.15943413057311243,     T1(  0.33333333333333333), T2(1.75)},
		{0.11654496129616534,     T1(  0.33333333333333333), T2(2.00)},
		{0.085809609306439674,    T1(  0.33333333333333333), T2(2.25)},
		{0.063542537454733386,    T1(  0.33333333333333333), T2(2.50)},
		{0.047273354184795509,    T1(  0.33333333333333333), T2(2.75)},
		{0.035305904902162587,    T1(  0.33333333333333333), T2(3.00)},
		{0.026454186892773169,    T1(  0.33333333333333333), T2(3.25)},
		{0.019877061407943805,    T1(  0.33333333333333333), T2(3.50)},
		{0.014971213514760216,    T1(  0.33333333333333333), T2(3.75)},
		{0.011299947573672166,    T1(  0.33333333333333333), T2(4.00)},
		{0.0085447959546110473,   T1(  0.33333333333333333), T2(4.25)},
		{0.0064720581217078245,   T1(  0.33333333333333333), T2(4.50)},
		{0.0049093342803275264,   T1(  0.33333333333333333), T2(4.75)},
		{0.0037288750960535887,   T1(  0.33333333333333333), T2(5.00)},

		{1.9521640631515476,      T1(  0.50000000000000000), T2(0.25)},
		{1.0750476034999195,      T1(  0.50000000000000000), T2(0.50)},
		{0.68361006034952432,     T1(  0.50000000000000000), T2(0.75)},
		{0.46106850444789443,     T1(  0.50000000000000000), T2(1.00)},
		{0.32117137397144746,     T1(  0.50000000000000000), T2(1.25)},
		{0.22833505222826550,     T1(  0.50000000000000000), T2(1.50)},
		{0.16463628997380861,     T1(  0.50000000000000000), T2(1.75)},
		{0.11993777196806145,     T1(  0.50000000000000000), T2(2.00)},
		{0.088065558803650454,    T1(  0.50000000000000000), T2(2.25)},
		{0.065065943154009986,    T1(  0.50000000000000000), T2(2.50)},
		{0.048315198301417825,    T1(  0.50000000000000000), T2(2.75)},
		{0.036025985131764589,    T1(  0.50000000000000000), T2(3.00)},
		{0.026956356532443351,    T1(  0.50000000000000000), T2(3.25)},
		{0.020229969578139294,    T1(  0.50000000000000000), T2(3.50)},
		{0.015220888252975568,    T1(  0.50000000000000000), T2(3.75)},
		{0.011477624576608053,    T1(  0.50000000000000000), T2(4.00)},
		{0.0086718932956978342,   T1(  0.50000000000000000), T2(4.25)},
		{0.0065633945646345424,   T1(  0.50000000000000000), T2(4.50)},
		{0.0049752435421262292,   T1(  0.50000000000000000), T2(4.75)},
		{0.0037766133746428825,   T1(  0.50000000000000000), T2(5.00)},

		{2.3289060745544101,      T1(  0.66666666666666666), T2(0.25)},
		{1.2059304647203353,      T1(  0.66666666666666666), T2(0.50)},
		{0.74547232976647226,     T1(  0.66666666666666666), T2(0.75)},
		{0.49447506210420811,     T1(  0.66666666666666666), T2(1.00)},
		{0.34062994813514252,     T1(  0.66666666666666666), T2(1.25)},
		{0.24024045240315581,     T1(  0.66666666666666666), T2(1.50)},
		{0.17217716908452307,     T1(  0.66666666666666666), T2(1.75)},
		{0.12483892748812841,     T1(  0.66666666666666666), T2(2.00)},
		{0.091315296079621050,    T1(  0.66666666666666666), T2(2.25)},
		{0.067255322171623361,    T1(  0.66666666666666666), T2(2.50)},
		{0.049809546542402224,    T1(  0.66666666666666666), T2(2.75)},
		{0.037057074495188531,    T1(  0.66666666666666666), T2(3.00)},
		{0.027674365504886729,    T1(  0.66666666666666666), T2(3.25)},
		{0.020733915836010912,    T1(  0.66666666666666666), T2(3.50)},
		{0.015577015510251336,    T1(  0.66666666666666666), T2(3.75)},
		{0.011730801456525337,    T1(  0.66666666666666666), T2(4.00)},
		{0.0088528343204658851,   T1(  0.66666666666666666), T2(4.25)},
		{0.0066933190915775568,   T1(  0.66666666666666666), T2(4.50)},
		{0.0050689292106255480,   T1(  0.66666666666666666), T2(4.75)},
		{0.0038444246344968226,   T1(  0.66666666666666666), T2(5.00)},

		{3.7470259744407115,      T1(  1.00000000000000000), T2(0.25)},
		{1.6564411200033007,      T1(  1.00000000000000000), T2(0.50)},
		{0.94958046696214016,     T1(  1.00000000000000000), T2(0.75)},
		{0.60190723019723458,     T1(  1.00000000000000000), T2(1.00)},
		{0.40212407978419540,     T1(  1.00000000000000000), T2(1.25)},
		{0.27738780045684375,     T1(  1.00000000000000000), T2(1.50)},
		{0.19547745347439305,     T1(  1.00000000000000000), T2(1.75)},
		{0.13986588181652262,     T1(  1.00000000000000000), T2(2.00)},
		{0.10121630256832535,     T1(  1.00000000000000000), T2(2.25)},
		{0.073890816347747038,    T1(  1.00000000000000000), T2(2.50)},
		{0.054318522758919859,    T1(  1.00000000000000000), T2(2.75)},
		{0.040156431128194198,    T1(  1.00000000000000000), T2(3.00)},
		{0.029825529796040143,    T1(  1.00000000000000000), T2(3.25)},
		{0.022239392925923845,    T1(  1.00000000000000000), T2(3.50)},
		{0.016638191754688916,    T1(  1.00000000000000000), T2(3.75)},
		{0.012483498887268437,    T1(  1.00000000000000000), T2(4.00)},
		{0.0093896806560432589,   T1(  1.00000000000000000), T2(4.25)},
		{0.0070780949089680918,   T1(  1.00000000000000000), T2(4.50)},
		{0.0053459218178228390,   T1(  1.00000000000000000), T2(4.75)},
		{0.0040446134454521655,   T1(  1.00000000000000000), T2(5.00)},

		{31.517714546773998,      T1(  2.00000000000000000), T2(0.25)},
		{7.5501835512408695,      T1(  2.00000000000000000), T2(0.50)},
		{3.1427970006821715,      T1(  2.00000000000000000), T2(0.75)},
		{1.6248388986351774,      T1(  2.00000000000000000), T2(1.00)},
		{0.94100161673881855,     T1(  2.00000000000000000), T2(1.25)},
		{0.58365596325665070,     T1(  2.00000000000000000), T2(1.50)},
		{0.37878261635733851,     T1(  2.00000000000000000), T2(1.75)},
		{0.25375975456605621,     T1(  2.00000000000000000), T2(2.00)},
		{0.17401315870205850,     T1(  2.00000000000000000), T2(2.25)},
		{0.12146020627856381,     T1(  2.00000000000000000), T2(2.50)},
		{0.085959281497066137,    T1(  2.00000000000000000), T2(2.75)},
		{0.061510458471742059,    T1(  2.00000000000000000), T2(3.00)},
		{0.044412927437333515,    T1(  2.00000000000000000), T2(3.25)},
		{0.032307121699467839,    T1(  2.00000000000000000), T2(3.50)},
		{0.023647953146296131,    T1(  2.00000000000000000), T2(3.75)},
		{0.017401425529487247,    T1(  2.00000000000000000), T2(4.00)},
		{0.012863060974445674,    T1(  2.00000000000000000), T2(4.25)},
		{0.0095456772027753493,   T1(  2.00000000000000000), T2(4.50)},
		{0.0071081190074975690,   T1(  2.00000000000000000), T2(4.75)},
		{0.0053089437122234608,   T1(  2.00000000000000000), T2(5.00)},

		{391683.98962334893,      T1(  5.00000000000000000), T2(0.25)},
		{12097.979476096394,      T1(  5.00000000000000000), T2(0.50)},
		{1562.5870339691098,      T1(  5.00000000000000000), T2(0.75)},
		{360.96058960124071,      T1(  5.00000000000000000), T2(1.00)},
//		{114.29321426334016,      T1(  5.00000000000000000), T2(1.25)},
		{44.067781159301056,      T1(  5.00000000000000000), T2(1.50)},
		{19.426568687730288,      T1(  5.00000000000000000), T2(1.75)},
		{9.4310491005964820,      T1(  5.00000000000000000), T2(2.00)},
		{4.9221270549918685,      T1(  5.00000000000000000), T2(2.25)},
		{2.7168842907865423,      T1(  5.00000000000000000), T2(2.50)},
		{1.5677685890536335,      T1(  5.00000000000000000), T2(2.75)},
		{0.93777360238680818,     T1(  5.00000000000000000), T2(3.00)},
		{0.57775534736785106,     T1(  5.00000000000000000), T2(3.25)},
		{0.36482440208451983,     T1(  5.00000000000000000), T2(3.50)},
		{0.23520290620082260,     T1(  5.00000000000000000), T2(3.75)},
		{0.15434254872599726,     T1(  5.00000000000000000), T2(4.00)},
		{0.10283347176876455,     T1(  5.00000000000000000), T2(4.25)},
		{0.069423643150881773,    T1(  5.00000000000000000), T2(4.50)},
		{0.047410616917942211,    T1(  5.00000000000000000), T2(4.75)},
		{0.032706273712031865,    T1(  5.00000000000000000), T2(5.00)},

		{194481817927839.88,      T1( 10.00000000000000000), T2(0.25)},
		{188937569319.90030,      T1( 10.00000000000000000), T2(0.50)},
		{3248187687.8018155,      T1( 10.00000000000000000), T2(0.75)},
		{180713289.90102944,      T1( 10.00000000000000000), T2(1.00)},
		{19104425.945252180,      T1( 10.00000000000000000), T2(1.25)},
		{3027483.5236822353,      T1( 10.00000000000000000), T2(1.50)},
		{633724.71555087867,      T1( 10.00000000000000000), T2(1.75)},
		{162482.40397955943,      T1( 10.00000000000000000), T2(2.00)},
		{48602.446087749791,      T1( 10.00000000000000000), T2(2.25)},
		{16406.916416341937,      T1( 10.00000000000000000), T2(2.50)},
		{6104.1720745909606,      T1( 10.00000000000000000), T2(2.75)},
		{2459.6204220569480,      T1( 10.00000000000000000), T2(3.00)},
		{1059.2358443703381,      T1( 10.00000000000000000), T2(3.25)},
		{482.53582096664758,      T1( 10.00000000000000000), T2(3.50)},
		{230.64249314993782,      T1( 10.00000000000000000), T2(3.75)},
		{114.91408364049623,      T1( 10.00000000000000000), T2(4.00)},
		{59.361613632706479,      T1( 10.00000000000000000), T2(4.25)},
		{31.652958759229872,      T1( 10.00000000000000000), T2(4.50)},
		{17.357723966417399,      T1( 10.00000000000000000), T2(4.75)},
		{9.7585628291778121,      T1( 10.00000000000000000), T2(5.00)},

		{7.0065983661641184e+34,  T1( 20.00000000000000000), T2(0.25)},
		{6.6655498744171593e+28,  T1( 20.00000000000000000), T2(0.50)},
		{1.9962989615380379e+25,  T1( 20.00000000000000000), T2(0.75)},
		{6.2943693604245335e+22,  T1( 20.00000000000000000), T2(1.00)},
		{7.2034511920074182e+20,  T1( 20.00000000000000000), T2(1.25)},
		{1.8620549984645546e+19,  T1( 20.00000000000000000), T2(1.50)},
		{8.4415605303952486e+17,  T1( 20.00000000000000000), T2(1.75)},
		{57708568527002520.,      T1( 20.00000000000000000), T2(2.00)},
		{5396824209986879.0,      T1( 20.00000000000000000), T2(2.25)},
		{645996884063683.62,      T1( 20.00000000000000000), T2(2.50)},
		{94387401970996.328,      T1( 20.00000000000000000), T2(2.75)},
		{16254643952204.371,      T1( 20.00000000000000000), T2(3.00)},
		{3212694836166.4053,      T1( 20.00000000000000000), T2(3.25)},
		{713857897923.74072,      T1( 20.00000000000000000), T2(3.50)},
		{175423421958.35925,      T1( 20.00000000000000000), T2(3.75)},
		{47050078926.298088,      T1( 20.00000000000000000), T2(4.00)},
		{13625066095.067503,      T1( 20.00000000000000000), T2(4.25)},
		{4222179870.6810660,      T1( 20.00000000000000000), T2(4.50)},
		{1389634112.7516634,      T1( 20.00000000000000000), T2(4.75)},
		{482700052.06214869,      T1( 20.00000000000000000), T2(5.00)},

		{4.3394604622138714e+107, T1( 50.00000000000000000), T2(0.25)},
		{3.8505298918269003e+92,  T1( 50.00000000000000000), T2(0.50)},
		{6.0292756894842793e+83,  T1( 50.00000000000000000), T2(0.75)},
		{3.4068968541617001e+77,  T1( 50.00000000000000000), T2(1.00)},
		{4.8485527365039051e+72,  T1( 50.00000000000000000), T2(1.25)},
		{5.3091717574907920e+68,  T1( 50.00000000000000000), T2(1.50)},
		{2.3762245257445824e+65,  T1( 50.00000000000000000), T2(1.75)},
		{2.9799817396049268e+62,  T1( 50.00000000000000000), T2(2.00)},
		{8.2079431233488581e+59,  T1( 50.00000000000000000), T2(2.25)},
		{4.2046528212987503e+57,  T1( 50.00000000000000000), T2(2.50)},
		{3.5578676911884825e+55,  T1( 50.00000000000000000), T2(2.75)},
		{4.5559542293221535e+53,  T1( 50.00000000000000000), T2(3.00)},
		{8.2606735967628997e+51,  T1( 50.00000000000000000), T2(3.25)},
		{2.0139406747903812e+50,  T1( 50.00000000000000000), T2(3.50)},
		{6.3368727837484613e+48,  T1( 50.00000000000000000), T2(3.75)},
		{2.4897317389325757e+47,  T1( 50.00000000000000000), T2(4.00)},
		{1.1888958173039699e+46,  T1( 50.00000000000000000), T2(4.25)},
		{6.7472593648148550e+44,  T1( 50.00000000000000000), T2(4.50)},
		{4.4664266585930700e+43,  T1( 50.00000000000000000), T2(4.75)},
		{3.3943222434301628e+42,  T1( 50.00000000000000000), T2(5.00)},

		{9.5039428115809898e+245, T1(100.00000000000000000), T2(0.25)},
		{7.4937399313533112e+215, T1(100.00000000000000000), T2(0.50)},
		{1.8417471020730699e+198, T1(100.00000000000000000), T2(0.75)},
		{5.9003331836386410e+185, T1(100.00000000000000000), T2(1.00)},
		{1.2002130935576950e+176, T1(100.00000000000000000), T2(1.25)},
		{1.4467044226487075e+168, T1(100.00000000000000000), T2(1.50)},
		{2.9161498411497642e+161, T1(100.00000000000000000), T2(1.75)},
		{4.6194159776013925e+155, T1(100.00000000000000000), T2(2.00)},
		{3.5332121583541727e+150, T1(100.00000000000000000), T2(2.25)},
		{9.3566097231039940e+145, T1(100.00000000000000000), T2(2.50)},
		{6.7672283615134532e+141, T1(100.00000000000000000), T2(2.75)},
		{1.1219630864949494e+138, T1(100.00000000000000000), T2(3.00)},
		{3.7329723699990903e+134, T1(100.00000000000000000), T2(3.25)},
		{2.2476893883855163e+131, T1(100.00000000000000000), T2(3.50)},
		{2.2564559319883200e+128, T1(100.00000000000000000), T2(3.75)},
		{3.5353340499626463e+125, T1(100.00000000000000000), T2(4.00)},
		{8.1898439213010234e+122, T1(100.00000000000000000), T2(4.25)},
		{2.6823744110726800e+120, T1(100.00000000000000000), T2(4.50)},
		{1.1963963615212274e+118, T1(100.00000000000000000), T2(4.75)},
		{7.0398601930616815e+115, T1(100.00000000000000000), T2(5.00)},

		{0.0036910983340425947,   T1(  0.00000000000000000), T2(  5)},
		{1.7780062316167647e-05,  T1(  0.00000000000000000), T2( 10)},
		{9.8195364823964333e-08,  T1(  0.00000000000000000), T2( 15)},
		{5.7412378153365238e-10,  T1(  0.00000000000000000), T2( 20)},
		{3.4641615622131151e-12,  T1(  0.00000000000000000), T2( 25)},
		{2.1324774964630566e-14,  T1(  0.00000000000000000), T2( 30)},
		{1.3310351491429464e-16,  T1(  0.00000000000000000), T2( 35)},
		{8.3928611000995700e-19,  T1(  0.00000000000000000), T2( 40)},
		{5.3334561226187247e-21,  T1(  0.00000000000000000), T2( 45)},
		{3.4101677497894956e-23,  T1(  0.00000000000000000), T2( 50)},
		{2.1913102183534147e-25,  T1(  0.00000000000000000), T2( 55)},
		{1.4138978405591074e-27,  T1(  0.00000000000000000), T2( 60)},
		{9.1544673210030045e-30,  T1(  0.00000000000000000), T2( 65)},
		{5.9446613372925013e-32,  T1(  0.00000000000000000), T2( 70)},
		{3.8701170455869113e-34,  T1(  0.00000000000000000), T2( 75)},
		{2.5251198425054720e-36,  T1(  0.00000000000000000), T2( 80)},
		{1.6507623579783908e-38,  T1(  0.00000000000000000), T2( 85)},
		{1.0810242556984256e-40,  T1(  0.00000000000000000), T2( 90)},
		{7.0901249699001278e-43,  T1(  0.00000000000000000), T2( 95)},
		{4.6566282291759025e-45,  T1(  0.00000000000000000), T2(100)},

		{0.0037288750960535887,   T1(  0.33333333333333333), T2(  5)},
		{1.7874608271055336e-05,  T1(  0.33333333333333333), T2( 10)},
		{9.8548341568798317e-08,  T1(  0.33333333333333333), T2( 15)},
		{5.7568278247790865e-10,  T1(  0.33333333333333333), T2( 20)},
		{3.4717201424907059e-12,  T1(  0.33333333333333333), T2( 25)},
		{2.1363664736611189e-14,  T1(  0.33333333333333333), T2( 30)},
		{1.3331202314165813e-16,  T1(  0.33333333333333333), T2( 35)},
		{8.4043837769480934e-19,  T1(  0.33333333333333333), T2( 40)},
		{5.3399731261024948e-21,  T1(  0.33333333333333333), T2( 45)},
		{3.4139217813583632e-23,  T1(  0.33333333333333333), T2( 50)},
		{2.1935050179185627e-25,  T1(  0.33333333333333333), T2( 55)},
		{1.4151968805623662e-27,  T1(  0.33333333333333333), T2( 60)},
		{9.1622357217019043e-30,  T1(  0.33333333333333333), T2( 65)},
		{5.9493479703461315e-32,  T1(  0.33333333333333333), T2( 70)},
		{3.8729660011055947e-34,  T1(  0.33333333333333333), T2( 75)},
		{2.5268631828013874e-36,  T1(  0.33333333333333333), T2( 80)},
		{1.6518353676138867e-38,  T1(  0.33333333333333333), T2( 85)},
		{1.0816880942511494e-40,  T1(  0.33333333333333333), T2( 90)},
		{7.0942508599231512e-43,  T1(  0.33333333333333333), T2( 95)},
		{4.6592031570213448e-45,  T1(  0.33333333333333333), T2(100)},

		{0.0037766133746428825,   T1(  0.50000000000000000), T2(  5)},
		{1.7993478093705178e-05,  T1(  0.50000000000000000), T2( 10)},
		{9.8991312032877236e-08,  T1(  0.50000000000000000), T2( 15)},
		{5.7763739747074450e-10,  T1(  0.50000000000000000), T2( 20)},
		{3.4811912768406949e-12,  T1(  0.50000000000000000), T2( 25)},
		{2.1412375659560111e-14,  T1(  0.50000000000000000), T2( 30)},
		{1.3357311366035824e-16,  T1(  0.50000000000000000), T2( 35)},
		{8.4188091949489049e-19,  T1(  0.50000000000000000), T2( 40)},
		{5.3481305002517408e-21,  T1(  0.50000000000000000), T2( 45)},
		{3.4186200954570754e-23,  T1(  0.50000000000000000), T2( 50)},
		{2.1962515908772453e-25,  T1(  0.50000000000000000), T2( 55)},
		{1.4168223500353693e-27,  T1(  0.50000000000000000), T2( 60)},
		{9.1719554473256892e-30,  T1(  0.50000000000000000), T2( 65)},
		{5.9552114337788932e-32,  T1(  0.50000000000000000), T2( 70)},
		{3.8765301321409432e-34,  T1(  0.50000000000000000), T2( 75)},
		{2.5290440439442907e-36,  T1(  0.50000000000000000), T2( 80)},
		{1.6531776067605980e-38,  T1(  0.50000000000000000), T2( 85)},
		{1.0825184636529955e-40,  T1(  0.50000000000000000), T2( 90)},
		{7.0994115873258822e-43,  T1(  0.50000000000000000), T2( 95)},
		{4.6624238126346709e-45,  T1(  0.50000000000000000), T2(100)},

		{0.0038444246344968226,   T1(  0.66666666666666666), T2(  5)},
		{1.8161187569530204e-05,  T1(  0.66666666666666666), T2( 10)},
		{9.9614751542305571e-08,  T1(  0.66666666666666666), T2( 15)},
		{5.8038484271925811e-10,  T1(  0.66666666666666666), T2( 20)},
		{3.4944937498488603e-12,  T1(  0.66666666666666666), T2( 25)},
		{2.1480755645577720e-14,  T1(  0.66666666666666666), T2( 30)},
		{1.3393949190152161e-16,  T1(  0.66666666666666666), T2( 35)},
		{8.4390460553642992e-19,  T1(  0.66666666666666666), T2( 40)},
		{5.3595716143622089e-21,  T1(  0.66666666666666666), T2( 45)},
		{3.4252085301433749e-23,  T1(  0.66666666666666666), T2( 50)},
		{2.2001025377982308e-25,  T1(  0.66666666666666666), T2( 55)},
		{1.4191011274172078e-27,  T1(  0.66666666666666666), T2( 60)},
		{9.1855803020269763e-30,  T1(  0.66666666666666666), T2( 65)},
		{5.9634299472578764e-32,  T1(  0.66666666666666666), T2( 70)},
		{3.8815254026478500e-34,  T1(  0.66666666666666666), T2( 75)},
		{2.5321003991943847e-36,  T1(  0.66666666666666666), T2( 80)},
		{1.6550585670593067e-38,  T1(  0.66666666666666666), T2( 85)},
		{1.0836820479428605e-40,  T1(  0.66666666666666666), T2( 90)},
		{7.1066428916285356e-43,  T1(  0.66666666666666666), T2( 95)},
		{4.6669364587280459e-45,  T1(  0.66666666666666666), T2(100)},

		{0.0040446134454521655,   T1(  1.00000000000000000), T2(  5)},
		{1.8648773453825579e-05,  T1(  1.00000000000000000), T2( 10)},
		{1.0141729369762091e-07,  T1(  1.00000000000000000), T2( 15)},
		{5.8830579695570384e-10,  T1(  1.00000000000000000), T2( 20)},
		{3.5327780731999345e-12,  T1(  1.00000000000000000), T2( 25)},
		{2.1677320018915498e-14,  T1(  1.00000000000000000), T2( 30)},
		{1.3499178340011053e-16,  T1(  1.00000000000000000), T2( 35)},
		{8.4971319548610435e-19,  T1(  1.00000000000000000), T2( 40)},
		{5.3923945937225035e-21,  T1(  1.00000000000000000), T2( 45)},
		{3.4441022267175555e-23,  T1(  1.00000000000000000), T2( 50)},
		{2.2111422716117463e-25,  T1(  1.00000000000000000), T2( 55)},
		{1.4256320265171041e-27,  T1(  1.00000000000000000), T2( 60)},
		{9.2246195278906156e-30,  T1(  1.00000000000000000), T2( 65)},
		{5.9869736739138550e-32,  T1(  1.00000000000000000), T2( 70)},
		{3.8958329467421912e-34,  T1(  1.00000000000000000), T2( 75)},
		{2.5408531275211705e-36,  T1(  1.00000000000000000), T2( 80)},
		{1.6604444948567571e-38,  T1(  1.00000000000000000), T2( 85)},
		{1.0870134457498335e-40,  T1(  1.00000000000000000), T2( 90)},
		{7.1273442329907240e-43,  T1(  1.00000000000000000), T2( 95)},
		{4.6798537356369088e-45,  T1(  1.00000000000000000), T2(100)},

		{0.0053089437122234608,   T1(  2.00000000000000000), T2(  5)},
		{2.1509817006932763e-05,  T1(  2.00000000000000000), T2( 10)},
		{1.1171767065031378e-07,  T1(  2.00000000000000000), T2( 15)},
		{6.3295436122922281e-10,  T1(  2.00000000000000000), T2( 20)},
		{3.7467838080691102e-12,  T1(  2.00000000000000000), T2( 25)},
		{2.2769929632558265e-14,  T1(  2.00000000000000000), T2( 30)},
		{1.4081733110858665e-16,  T1(  2.00000000000000000), T2( 35)},
		{8.8177176978426223e-19,  T1(  2.00000000000000000), T2( 40)},
		{5.5731181045619470e-21,  T1(  2.00000000000000000), T2( 45)},
		{3.5479318388581979e-23,  T1(  2.00000000000000000), T2( 50)},
		{2.2717153918665688e-25,  T1(  2.00000000000000000), T2( 55)},
		{1.4614189081096777e-27,  T1(  2.00000000000000000), T2( 60)},
		{9.4383017680150234e-30,  T1(  2.00000000000000000), T2( 65)},
		{6.1157177279757537e-32,  T1(  2.00000000000000000), T2( 70)},
		{3.9740059241667034e-34,  T1(  2.00000000000000000), T2( 75)},
		{2.5886411706935012e-36,  T1(  2.00000000000000000), T2( 80)},
		{1.6898316402103142e-38,  T1(  2.00000000000000000), T2( 85)},
		{1.1051801100484218e-40,  T1(  2.00000000000000000), T2( 90)},
		{7.2401743221736176e-43,  T1(  2.00000000000000000), T2( 95)},
		{4.7502253038886407e-45,  T1(  2.00000000000000000), T2(100)},

		{0.032706273712031865,    T1(  5.00000000000000000), T2(  5)},
		{5.7541849985312275e-05,  T1(  5.00000000000000000), T2( 10)},
		{2.1878261369258224e-07,  T1(  5.00000000000000000), T2( 15)},
		{1.0538660139974233e-09,  T1(  5.00000000000000000), T2( 20)},
		{5.6485921365284157e-12,  T1(  5.00000000000000000), T2( 25)},
		{3.2103335105890266e-14,  T1(  5.00000000000000000), T2( 30)},
		{1.8919208406439644e-16,  T1(  5.00000000000000000), T2( 35)},
		{1.1423814375953188e-18,  T1(  5.00000000000000000), T2( 40)},
		{7.0181216822204101e-21,  T1(  5.00000000000000000), T2( 45)},
		{4.3671822541009859e-23,  T1(  5.00000000000000000), T2( 50)},
		{2.7444967640357869e-25,  T1(  5.00000000000000000), T2( 55)},
		{1.7382232741886986e-27,  T1(  5.00000000000000000), T2( 60)},
		{1.1078474298959669e-29,  T1(  5.00000000000000000), T2( 65)},
		{7.0974537081794416e-32,  T1(  5.00000000000000000), T2( 70)},
		{4.5667269500061064e-34,  T1(  5.00000000000000000), T2( 75)},
		{2.9491764420206146e-36,  T1(  5.00000000000000000), T2( 80)},
		{1.9105685973117463e-38,  T1(  5.00000000000000000), T2( 85)},
		{1.2411034311592645e-40,  T1(  5.00000000000000000), T2( 90)},
		{8.0814211331379146e-43,  T1(  5.00000000000000000), T2( 95)},
		{5.2732561132929503e-45,  T1(  5.00000000000000000), T2(100)},

		{9.7585628291778121,      T1( 10.00000000000000000), T2(  5)},
		{0.0016142553003906698,   T1( 10.00000000000000000), T2( 10)},
		{2.2605303776606435e-06,  T1( 10.00000000000000000), T2( 15)},
		{6.3162145283215804e-09,  T1( 10.00000000000000000), T2( 20)},
		{2.4076769602801233e-11,  T1( 10.00000000000000000), T2( 25)},
		{1.0842816942222975e-13,  T1( 10.00000000000000000), T2( 30)},
		{5.3976770429777191e-16,  T1( 10.00000000000000000), T2( 35)},
		{2.8680293113671932e-18,  T1( 10.00000000000000000), T2( 40)},
		{1.5939871900169600e-20,  T1( 10.00000000000000000), T2( 45)},
		{9.1509882099879962e-23,  T1( 10.00000000000000000), T2( 50)},
		{5.3823846249592858e-25,  T1( 10.00000000000000000), T2( 55)},
		{3.2253408700563144e-27,  T1( 10.00000000000000000), T2( 60)},
		{1.9613367530075138e-29,  T1( 10.00000000000000000), T2( 65)},
		{1.2068471495933484e-31,  T1( 10.00000000000000000), T2( 70)},
		{7.4979152649449644e-34,  T1( 10.00000000000000000), T2( 75)},
		{4.6957285830490531e-36,  T1( 10.00000000000000000), T2( 80)},
		{2.9606323347034079e-38,  T1( 10.00000000000000000), T2( 85)},
		{1.8773542561131613e-40,  T1( 10.00000000000000000), T2( 90)},
		{1.1962899527846350e-42,  T1( 10.00000000000000000), T2( 95)},
		{7.6554279773881006e-45,  T1( 10.00000000000000000), T2(100)},

		{482700052.06214869,      T1( 20.00000000000000000), T2(  5)},
		{178.74427820770543,      T1( 20.00000000000000000), T2( 10)},
		{0.012141257729731143,    T1( 20.00000000000000000), T2( 15)},
		{5.5431116361258155e-06,  T1( 20.00000000000000000), T2( 20)},
		{6.3744029330352113e-09,  T1( 20.00000000000000000), T2( 25)},
		{1.2304516475442478e-11,  T1( 20.00000000000000000), T2( 30)},
		{3.2673136479809018e-14,  T1( 20.00000000000000000), T2( 35)},
		{1.0703023799997383e-16,  T1( 20.00000000000000000), T2( 40)},
		{4.0549953175660457e-19,  T1( 20.00000000000000000), T2( 45)},
		{1.7061483797220349e-21,  T1( 20.00000000000000000), T2( 50)},
		{7.7617008115659413e-24,  T1( 20.00000000000000000), T2( 55)},
		{3.7482954006874720e-26,  T1( 20.00000000000000000), T2( 60)},
		{1.8966880763956576e-28,  T1( 20.00000000000000000), T2( 65)},
		{9.9615763479998864e-31,  T1( 20.00000000000000000), T2( 70)},
		{5.3921623063091066e-33,  T1( 20.00000000000000000), T2( 75)},
		{2.9920407657642266e-35,  T1( 20.00000000000000000), T2( 80)},
		{1.6948662723618255e-37,  T1( 20.00000000000000000), T2( 85)},
		{9.7689149642963042e-40,  T1( 20.00000000000000000), T2( 90)},
		{5.7143603019220823e-42,  T1( 20.00000000000000000), T2( 95)},
		{3.3852054148901695e-44,  T1( 20.00000000000000000), T2(100)},

		{3.3943222434301628e+42,  T1( 50.00000000000000000), T2(  5)},
		{2.0613737753892554e+27,  T1( 50.00000000000000000), T2( 10)},
		{1.7267736974519188e+18,  T1( 50.00000000000000000), T2( 15)},
		{411711209122.01788,      T1( 50.00000000000000000), T2( 20)},
		{1972478.7419813874,      T1( 50.00000000000000000), T2( 25)},
		{58.770686258007267,      T1( 50.00000000000000000), T2( 30)},
		{0.0058659391182535178,   T1( 50.00000000000000000), T2( 35)},
		{1.3634854128794101e-06,  T1( 50.00000000000000000), T2( 40)},
		{5.8652396362160819e-10,  T1( 50.00000000000000000), T2( 45)},
		{4.0060134766400893e-13,  T1( 50.00000000000000000), T2( 50)},
		{3.9062324485711016e-16,  T1( 50.00000000000000000), T2( 55)},
		{5.0389298085176510e-19,  T1( 50.00000000000000000), T2( 60)},
		{8.1305344250110424e-22,  T1( 50.00000000000000000), T2( 65)},
		{1.5732816234948991e-24,  T1( 50.00000000000000000), T2( 70)},
		{3.5349854993874412e-27,  T1( 50.00000000000000000), T2( 75)},
		{8.9940101003189471e-30,  T1( 50.00000000000000000), T2( 80)},
		{2.5403205503080723e-32,  T1( 50.00000000000000000), T2( 85)},
		{7.8397596486715721e-35,  T1( 50.00000000000000000), T2( 90)},
//		{2.6098900651329542e-37,  T1( 50.00000000000000000), T2( 95)},
		{9.2745226536133242e-40,  T1( 50.00000000000000000), T2(100)},

		{7.0398601930616815e+115, T1(100.00000000000000000), T2(  5)},
		{4.5966740842695231e+85,  T1(100.00000000000000000), T2( 10)},
		{8.2565552242653946e+67,  T1(100.00000000000000000), T2( 15)},
		{1.7081356456876041e+55,  T1(100.00000000000000000), T2( 20)},
		{1.9858028128780610e+45,  T1(100.00000000000000000), T2( 25)},
		{1.2131584253026677e+37,  T1(100.00000000000000000), T2( 30)},
		{1.1016916354696688e+30,  T1(100.00000000000000000), T2( 35)},
		{7.0074023297775712e+23,  T1(100.00000000000000000), T2( 40)},
		{1.9236643958470894e+18,  T1(100.00000000000000000), T2( 45)},
		{16394035276269.250,      T1(100.00000000000000000), T2( 50)},
		{343254952.89495474,      T1(100.00000000000000000), T2( 55)},
		{14870.012754946298,      T1(100.00000000000000000), T2( 60)},
		{1.1708099078572216,      T1(100.00000000000000000), T2( 65)},
		{0.00015161193930722313,  T1(100.00000000000000000), T2( 70)},
		{2.9850234381623443e-08,  T1(100.00000000000000000), T2( 75)},
		{8.3928710724649113e-12,  T1(100.00000000000000000), T2( 80)},
		{3.2033435630927732e-15,  T1(100.00000000000000000), T2( 85)},
		{1.5922281431788096e-18,  T1(100.00000000000000000), T2( 90)},
//		{9.9589454577674131e-22,  T1(100.00000000000000000), T2( 95)},
//		{7.6171296304940831e-25,  T1(100.00000000000000000), T2(100)},
	};

	for (auto const& data : testcases)
	{
		auto const r = hamon::cyl_bessel_k(data.nu, data.x);

		if (data.expected > max)
		{
			EXPECT_EQ(+inf, r);
		}
		else if (data.expected < lowest)
		{
			EXPECT_EQ(-inf, r);
		}
		else if (0 <= data.expected && data.expected < min)
		{
			EXPECT_GT(min, r);
		}
		else
		{
			double tole = hamon::abs(data.expected) * error;
			EXPECT_NEAR(data.expected, (double)r, tole);
		}
	}
}

GTEST_TEST(CMathTest, CylBesselKTest)
{
	CylBesselKTest<float,       float>      ();
	CylBesselKTest<float,       double>     ();
	CylBesselKTest<float,       long double>();
	CylBesselKTest<double,      float>      ();
	CylBesselKTest<double,      double>     ();
	CylBesselKTest<double,      long double>();
	CylBesselKTest<long double, float>      ();
	CylBesselKTest<long double, double>     ();
	CylBesselKTest<long double, long double>();

	HAMON_CXX11_CONSTEXPR auto nanf = hamon::numeric_limits<float>::quiet_NaN();
	HAMON_CXX14_CONSTEXPR_EXPECT_TRUE(hamon::isnan(hamon::cyl_bessel_kf(nanf, nanf)));
	HAMON_CXX14_CONSTEXPR_EXPECT_TRUE(hamon::isnan(hamon::cyl_bessel_kf(nanf, 0.0f)));
	HAMON_CXX14_CONSTEXPR_EXPECT_TRUE(hamon::isnan(hamon::cyl_bessel_kf(0.0f, nanf)));

	HAMON_CXX11_CONSTEXPR auto nanl = hamon::numeric_limits<long double>::quiet_NaN();
	HAMON_CXX14_CONSTEXPR_EXPECT_TRUE(hamon::isnan(hamon::cyl_bessel_kl(nanl, nanl)));
	HAMON_CXX14_CONSTEXPR_EXPECT_TRUE(hamon::isnan(hamon::cyl_bessel_kl(nanl, 0.0l)));
	HAMON_CXX14_CONSTEXPR_EXPECT_TRUE(hamon::isnan(hamon::cyl_bessel_kl(0.0l, nanl)));
}

}	// namespace cyl_bessel_k_test

}	// namespace hamon_cmath_test
